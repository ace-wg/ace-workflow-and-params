<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Short Distribution Chain (SDC) Workflow and New OAuth Parameters for the Authentication and Authorization for Constrained Environments (ACE) Framework</title>
<meta content="Marco Tiloca" name="author">
<meta content="Göran Selander" name="author">
<meta content="
       This document updates the Authentication and Authorization for Constrained Environments framework (ACE, RFC 9200) as follows. (1) It defines the Short Distribution Chain (SDC) workflow that the authorization server (AS) can use for uploading an access token to a resource server on behalf of the client. (2) For the OAuth 2.0 token endpoint, it defines new parameters and encodings and it extends the semantics of the &quot;ace_profile&quot; parameter. (3) For the OAuth 2.0 authz-info endpoint, it defines a new parameter and its encoding. (4) It defines how the client and the AS can coordinate on the exchange of the client's and resource server's public authentication credentials, when those can be transported by value or identified by reference; this extends the semantics of the &quot;rs_cnf&quot; parameter for the OAuth 2.0 token endpoint, thus updating RFC 9201. (5) It extends the error handling at the AS, for which it defines a new error code. (6) It deprecates the original payload format of error responses conveying an error code, when CBOR is used to encode message payloads. For those responses, it defines a new payload format aligned with RFC 9290, thus updating in this respect also the profiles defined in RFC 9202, RFC 9203, and RFC 9431. (7) It amends two of the requirements on profiles of the framework. 
    " name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-ace-workflow-and-params-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.12.12
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.2.1
    Jinja2 3.1.6
    lxml 6.0.2
    platformdirs 4.5.1
    pycountry 24.6.1
    PyYAML 6.0.3
    requests 2.32.5
    wcwidth 0.3.0
-->
<link href="draft-ietf-ace-workflow-and-params.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
  border-left: 2px var(--pilcrow-strong) solid;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow, a.pilcrow:focus {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">New ACE Workflow and Parameters</td>
<td class="right">February 2026</td>
</tr></thead>
<tfoot><tr>
<td class="left">Tiloca &amp; Selander</td>
<td class="center">Expires 19 August 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">ACE Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-ace-workflow-and-params-latest</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc9200" class="eref">9200</a>, <a href="https://www.rfc-editor.org/rfc/rfc9201" class="eref">9201</a>, <a href="https://www.rfc-editor.org/rfc/rfc9202" class="eref">9202</a>, <a href="https://www.rfc-editor.org/rfc/rfc9203" class="eref">9203</a>, <a href="https://www.rfc-editor.org/rfc/rfc9431" class="eref">9431</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2026-02-15" class="published">15 February 2026</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-08-19">19 August 2026</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Tiloca</div>
<div class="org">RISE AB</div>
</div>
<div class="author">
      <div class="author-name">G. Selander</div>
<div class="org">Ericsson AB</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Short Distribution Chain (SDC) Workflow and New OAuth Parameters for the Authentication and Authorization for Constrained Environments (ACE) Framework</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document updates the Authentication and Authorization for Constrained Environments framework (ACE, RFC 9200) as follows. (1) It defines the Short Distribution Chain (SDC) workflow that the authorization server (AS) can use for uploading an access token to a resource server on behalf of the client. (2) For the OAuth 2.0 token endpoint, it defines new parameters and encodings and it extends the semantics of the "ace_profile" parameter. (3) For the OAuth 2.0 authz-info endpoint, it defines a new parameter and its encoding. (4) It defines how the client and the AS can coordinate on the exchange of the client's and resource server's public authentication credentials, when those can be transported by value or identified by reference; this extends the semantics of the "rs_cnf" parameter for the OAuth 2.0 token endpoint, thus updating RFC 9201. (5) It extends the error handling at the AS, for which it defines a new error code. (6) It deprecates the original payload format of error responses conveying an error code, when CBOR is used to encode message payloads. For those responses, it defines a new payload format aligned with RFC 9290, thus updating in this respect also the profiles defined in RFC 9202, RFC 9203, and RFC 9431. (7) It amends two of the requirements on profiles of the framework.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-ace-workflow-and-params/">https://datatracker.ietf.org/doc/draft-ietf-ace-workflow-and-params/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Authentication and Authorization for Constrained Environments (ace) Working Group mailing list (<span><a href="mailto:ace@ietf.org">mailto:ace@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/ace/">https://mailarchive.ietf.org/arch/browse/ace/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/ace/">https://www.ietf.org/mailman/listinfo/ace/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/ace-wg/ace-workflow-and-params">https://github.com/ace-wg/ace-workflow-and-params</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 19 August 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2026 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-the-short-distribution-chai" class="internal xref">The Short Distribution Chain (SDC) Workflow</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-token-upload" class="internal xref">Token Upload</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-new-parameters" class="internal xref">New Parameters</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-token_upload" class="internal xref">token_upload</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="auto internal xref">3.1.1</a>.  <a href="#name-examples" class="internal xref">Examples</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-token_hash" class="internal xref">token_hash</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="auto internal xref">3.2.1</a>.  <a href="#name-computing-the-token-hash" class="internal xref">Computing the Token Hash</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="auto internal xref">3.2.2</a>.  <a href="#name-example" class="internal xref">Example</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-to_rs-and-from_rs" class="internal xref">to_rs and from_rs</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="auto internal xref">3.3.1</a>.  <a href="#name-to_rs" class="internal xref">to_rs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.2">
                    <p id="section-toc.1-1.3.2.3.2.2.1"><a href="#section-3.3.2" class="auto internal xref">3.3.2</a>.  <a href="#name-from_rs" class="internal xref">from_rs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.3">
                    <p id="section-toc.1-1.3.2.3.2.3.1"><a href="#section-3.3.3" class="auto internal xref">3.3.3</a>.  <a href="#name-use-with-the-oscore-profile" class="internal xref">Use with the OSCORE Profile</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-rs_cnf2-and-audience2" class="internal xref">rs_cnf2 and audience2</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.1">
                    <p id="section-toc.1-1.3.2.4.2.1.1"><a href="#section-3.4.1" class="auto internal xref">3.4.1</a>.  <a href="#name-example-2" class="internal xref">Example</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-anchor_cnf" class="internal xref">anchor_cnf</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.1">
                    <p id="section-toc.1-1.3.2.5.2.1.1"><a href="#section-3.5.1" class="auto internal xref">3.5.1</a>.  <a href="#name-example-3" class="internal xref">Example</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="auto internal xref">3.6</a>.  <a href="#name-token_series_id" class="internal xref">token_series_id</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="auto internal xref">3.7</a>.  <a href="#name-updated_rights" class="internal xref">updated_rights</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-updated-ace_profile-paramet" class="internal xref">Updated "ace_profile" Parameter</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-coordinating-on-the-exchang" class="internal xref">Coordinating on the Exchange of Public Authentication Credentials</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-instructing-c-on-how-to-pro" class="internal xref">Instructing C on How to Provide its Authentication Credential</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-instructing-the-as-on-how-t" class="internal xref">Instructing the AS on How to Provide the RS's Authentication Credential</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-failed-verification-of-proo" class="internal xref">Failed Verification of Proof of Possession at the AS</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-updated-payload-format-of-e" class="internal xref">Updated Payload Format of Error Responses</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-updated-requirements-on-pro" class="internal xref">Updated Requirements on Profiles of ACE</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-oauth-parameters-registry" class="internal xref">OAuth Parameters Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-oauth-parameters-cbor-mappi" class="internal xref">OAuth Parameters CBOR Mappings Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="auto internal xref">10.3</a>.  <a href="#name-json-web-token-claims-regis" class="internal xref">JSON Web Token Claims Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a href="#section-10.4" class="auto internal xref">10.4</a>.  <a href="#name-cbor-web-token-cwt-claims-r" class="internal xref">CBOR Web Token (CWT) Claims Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.5">
                <p id="section-toc.1-1.10.2.5.1"><a href="#section-10.5" class="auto internal xref">10.5</a>.  <a href="#name-oauth-extensions-error-regi" class="internal xref">OAuth Extensions Error Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.6">
                <p id="section-toc.1-1.10.2.6.1"><a href="#section-10.6" class="auto internal xref">10.6</a>.  <a href="#name-oauth-error-code-cbor-mappi" class="internal xref">OAuth Error Code CBOR Mappings Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.7">
                <p id="section-toc.1-1.10.2.7.1"><a href="#section-10.7" class="auto internal xref">10.7</a>.  <a href="#name-custom-problem-detail-keys-" class="internal xref">Custom Problem Detail Keys Registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-benefits-for-ace-profiles" class="internal xref">Benefits for ACE Profiles</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-dtls-profile" class="internal xref">DTLS Profile</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-edhoc-and-oscore-profile" class="internal xref">EDHOC and OSCORE Profile</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-cddl-model" class="internal xref">CDDL Model</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-document-updates" class="internal xref">Document Updates</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#appendix-C.1" class="auto internal xref">C.1</a>.  <a href="#name-version-06-to-07" class="internal xref">Version -06 to -07</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#appendix-C.2" class="auto internal xref">C.2</a>.  <a href="#name-version-05-to-06" class="internal xref">Version -05 to -06</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.3">
                <p id="section-toc.1-1.14.2.3.1"><a href="#appendix-C.3" class="auto internal xref">C.3</a>.  <a href="#name-version-04-to-05" class="internal xref">Version -04 to -05</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.4">
                <p id="section-toc.1-1.14.2.4.1"><a href="#appendix-C.4" class="auto internal xref">C.4</a>.  <a href="#name-version-03-to-04" class="internal xref">Version -03 to -04</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.5">
                <p id="section-toc.1-1.14.2.5.1"><a href="#appendix-C.5" class="auto internal xref">C.5</a>.  <a href="#name-version-02-to-03" class="internal xref">Version -02 to -03</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.6">
                <p id="section-toc.1-1.14.2.6.1"><a href="#appendix-C.6" class="auto internal xref">C.6</a>.  <a href="#name-version-01-to-02" class="internal xref">Version -01 to -02</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.7">
                <p id="section-toc.1-1.14.2.7.1"><a href="#appendix-C.7" class="auto internal xref">C.7</a>.  <a href="#name-version-00-to-01" class="internal xref">Version -00 to -01</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-E" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The Authentication and Authorization for Constrained Environments (ACE) framework <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> defines an architecture to enforce access control for constrained devices. A client (C) requests an assertion of granted permissions from an authorization server (AS) in the form of an access token, then uploads the access token to the target resource server (RS), and finally accesses protected resources at the RS according to the permissions specified in the access token.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The framework has as main building blocks the OAuth 2.0 framework <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>, the Constrained Application Protocol (CoAP) <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span> for message transfer, Concise Binary Object Representation (CBOR) <span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span> for compact encoding, and CBOR Object Signing and Encryption (COSE) <span>[<a href="#RFC9052" class="cite xref">RFC9052</a>]</span><span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span> for self-contained protection of access tokens. In addition, separate profile documents define in detail how the participants in the ACE architecture communicate, especially as to the security protocols that they use.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">The present document updates <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> as follows.<a href="#section-1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-4.1">
          <p id="section-1-4.1.1">It defines the Short Distribution Chain (SDC) workflow for the ACE framework (see <a href="#sec-workflow" class="auto internal xref">Section 2</a> of the present document), according to which the AS uploads the access token to the RS on behalf of C and then informs C about the outcome. The SDC workflow is especially convenient in deployments where the communication leg between C and the RS is constrained, but the communication leg between the AS and the RS is not.<a href="#section-1-4.1.1" class="pilcrow">¶</a></p>
<p id="section-1-4.1.2">
The SDC workflow has no ambition to replace the original workflow defined in <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. The AS can use one workflow or the other, depending, for example, on the specific RS for which an access token has been issued and the nature of the communication leg with that RS.<a href="#section-1-4.1.2" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-4.2">
          <p id="section-1-4.2.1">It defines new parameters and encodings for the OAuth 2.0 token endpoint at the AS (see <a href="#sec-parameters" class="auto internal xref">Section 3</a> of the present document). These include:<a href="#section-1-4.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-4.2.2.1">
              <p id="section-1-4.2.2.1.1">"token_upload", used by C to inform the AS that it opts in to use the SDC workflow and by the AS to inform C about the outcome of the token uploading to the RS per the SDC workflow.<a href="#section-1-4.2.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1-4.2.2.2">
              <p id="section-1-4.2.2.2.1">"token_hash", used by the AS to provide C with a token hash, which corresponds to an access token that the AS has issued for C and has successfully uploaded to the RS on behalf of C per the SDC workflow.<a href="#section-1-4.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1-4.2.2.3">
              <p id="section-1-4.2.2.3.1">"to_rs", used by C to provide the AS with information to relay to the RS, upon asking the AS to upload the access token to the RS per the SDC workflow. Its specific use with the OSCORE profile <span>[<a href="#RFC9203" class="cite xref">RFC9203</a>]</span> is also described, as effectively enabling the use of the SDC workflow for that profile.<a href="#section-1-4.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1-4.2.2.4">
              <p id="section-1-4.2.2.4.1">"from_rs", used by the AS to provide C with information to relay from the RS, after the AS has successfully uploaded the access token to the RS per the SDC workflow. Its specific use with the OSCORE profile <span>[<a href="#RFC9203" class="cite xref">RFC9203</a>]</span> is also described, as effectively enabling the use of the SDC workflow for that profile.<a href="#section-1-4.2.2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1-4.2.2.5">
              <p id="section-1-4.2.2.5.1">"rs_cnf2", used by the AS to provide C with the public keys of the RSs in the group-audience for which the access token is issued (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-6.9" class="relref">Section 6.9</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>).<a href="#section-1-4.2.2.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1-4.2.2.6">
              <p id="section-1-4.2.2.6.1">"audience2", used by the AS to provide C with the identifiers of the RSs in the group-audience for which the access token is issued.<a href="#section-1-4.2.2.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1-4.2.2.7">
              <p id="section-1-4.2.2.7.1">"anchor_cnf", used by the AS to provide C with the public keys of trust anchors, which C can use to validate the public key of an RS (e.g., as provided in the "rs_cnf" parameter defined in <span>[<a href="#RFC9201" class="cite xref">RFC9201</a>]</span> or in the "rs_cnf2" parameter defined in the present document).<a href="#section-1-4.2.2.7.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1-4.2.2.8">
              <p id="section-1-4.2.2.8.1">"token_series_id", used by the AS to provide C with the identifier of a token series and by C to ask the AS for a new access token in the same token series that dynamically updates access rights. A corresponding access token claim, namely "token_series_id", is also defined.<a href="#section-1-4.2.2.8.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1-4.2.2.9">
              <p id="section-1-4.2.2.9.1">"updated_rights", used by the AS to provide the RS with an indication that an access token uploaded per the SDC workflow is not the first one of a new token series, i.e., that the AS has issued the access token for dynamically updating the access rights of C.<a href="#section-1-4.2.2.9.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="section-1-4.3">
          <p id="section-1-4.3.1">It extends the semantics of the "ace_profile" parameter for the OAuth 2.0 token endpoint at the authorization server defined in <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> (see <a href="#sec-updated-ace-profile-parameter" class="auto internal xref">Section 4</a> of the present document).<a href="#section-1-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-4.4">
          <p id="section-1-4.4.1">It defines how C and the AS can coordinate on the exchange of the client's and resource server's public authentication credentials, when those can be transported by value or identified by reference in the access token request and response (see <a href="#sec-coord-exchanged-cred" class="auto internal xref">Section 5</a> of the present document).<a href="#section-1-4.4.1" class="pilcrow">¶</a></p>
<p id="section-1-4.4.2">
This extends the semantics of the "rs_cnf" parameter for the OAuth 2.0 token endpoint defined in <span><a href="https://rfc-editor.org/rfc/rfc9201#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC9201" class="cite xref">RFC9201</a>]</span>. Therefore, it updates <span>[<a href="#RFC9201" class="cite xref">RFC9201</a>]</span>.<a href="#section-1-4.4.2" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-4.5">
          <p id="section-1-4.5.1">It extends the error handling at the AS, for which it defines a new error code that the AS can use for error responses sent to the client, after failing to verify the proof of possession of the client's private key when processing an access token request (see <a href="#sec-error-failed-pop" class="auto internal xref">Section 6</a> of the present document).<a href="#section-1-4.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-4.6">
          <p id="section-1-4.6.1">It deprecates the original payload format of error responses that convey an error code, when CBOR is used to encode message payloads in the ACE framework. For such error responses, it defines a new payload format according to the problem-details format specified in <span>[<a href="#RFC9290" class="cite xref">RFC9290</a>]</span> (see <a href="#sec-updated-error-responses" class="auto internal xref">Section 7</a> of the present document).<a href="#section-1-4.6.1" class="pilcrow">¶</a></p>
<p id="section-1-4.6.2">
In this respect, it also updates the profiles of the ACE framework defined in <span>[<a href="#RFC9202" class="cite xref">RFC9202</a>]</span>, <span>[<a href="#RFC9203" class="cite xref">RFC9203</a>]</span>, and <span>[<a href="#RFC9431" class="cite xref">RFC9431</a>]</span>.<a href="#section-1-4.6.2" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-4.7">
          <p id="section-1-4.7.1">It amends two of the requirements on profiles of the ACE framework originally compiled in <span><a href="https://rfc-editor.org/rfc/rfc9200#appendix-C" class="relref">Appendix C</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> (see <a href="#sec-updated-requirements" class="auto internal xref">Section 8</a> of the present document).<a href="#section-1-4.7.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">Readers are expected to be familiar with the terms and concepts related to the ACE framework for Authentication and Authorization <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span><span>[<a href="#RFC9201" class="cite xref">RFC9201</a>]</span>, as well as with terms and concepts related to CBOR Web Tokens (CWTs) <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span> and CWT Confirmation Methods <span>[<a href="#RFC8747" class="cite xref">RFC8747</a>]</span>.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">The terminology for entities in the considered architecture is defined in OAuth 2.0 <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>. In particular, this includes client (C), resource server (RS), and authorization server (AS).<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<p id="section-1.1-4">Readers are also expected to be familiar with the terms and concepts related to CoAP <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>, Concise Data Definition Language (CDDL) <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span>, CBOR <span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span>, JavaScript Object Notation (JSON) <span>[<a href="#RFC8259" class="cite xref">RFC8259</a>]</span>, and COSE <span>[<a href="#RFC9052" class="cite xref">RFC9052</a>]</span><span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span>.<a href="#section-1.1-4" class="pilcrow">¶</a></p>
<p id="section-1.1-5">Note that the term "endpoint" is used here following its OAuth definition <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>, aimed at denoting resources such as /token and /introspect at the AS, and /authz-info at the RS. The CoAP definition, which is "[a]n entity participating in the CoAP protocol" <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>, is not used in this document.<a href="#section-1.1-5" class="pilcrow">¶</a></p>
<p id="section-1.1-6">Furthermore, this document uses the following terms.<a href="#section-1.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-7.1">
            <p id="section-1.1-7.1.1">Token series: a set of access tokens, all of which are bound to the same proof-of-possession (PoP) key and are sequentially issued by the same AS for the same pair (client, audience) per the same profile of ACE. A token series ends when the latest access token of that token series becomes invalid (e.g., when it expires or gets revoked).<a href="#section-1.1-7.1.1" class="pilcrow">¶</a></p>
<p id="section-1.1-7.1.2">
Profiles of ACE can provide their extended and specialized definition, e.g., by further taking into account the public authentication credentials of C and the RS.<a href="#section-1.1-7.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-7.2">
            <p id="section-1.1-7.2.1">Token hash: identifier of an access token, in binary format encoding. The token hash has no relation with other access token identifiers possibly used, such as the 'cti' (CWT ID) claim of CWTs <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>.<a href="#section-1.1-7.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.1-8">CBOR <span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span> and CDDL <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> are used in this document. CDDL predefined type names, especially bstr for CBOR byte strings and tstr for CBOR text strings, are used extensively in this document.<a href="#section-1.1-8" class="pilcrow">¶</a></p>
<p id="section-1.1-9">Examples throughout this document are expressed in CBOR diagnostic notation as defined in <span><a href="https://rfc-editor.org/rfc/rfc8949#section-8" class="relref">Section 8</a> of [<a href="#RFC8949" class="cite xref">RFC8949</a>]</span> and <span><a href="https://rfc-editor.org/rfc/rfc8610#appendix-G" class="relref">Appendix G</a> of [<a href="#RFC8610" class="cite xref">RFC8610</a>]</span>. Diagnostic notation comments are often used to provide a textual representation of the parameters' keys and values.<a href="#section-1.1-9" class="pilcrow">¶</a></p>
<p id="section-1.1-10">In the CBOR diagnostic notation used in this document, constructs of the form e'SOME_NAME' are replaced by the value assigned to SOME_NAME in the CDDL model shown in <a href="#fig-cddl-model" class="auto internal xref">Figure 11</a> of <a href="#sec-cddl-model" class="auto internal xref">Appendix B</a>. For example, {e'audience2' : ["rs1", "rs2"]} stands for {54 : ["rs1", "rs2"]}.<a href="#section-1.1-10" class="pilcrow">¶</a></p>
<p id="section-1.1-11">Note to RFC Editor: Please delete the paragraph immediately preceding this note. Also, in the CBOR diagnostic notation used in this document, please replace the constructs of the form e'SOME_NAME' with the value assigned to SOME_NAME in the CDDL model shown in <a href="#fig-cddl-model" class="auto internal xref">Figure 11</a> of <a href="#sec-cddl-model" class="auto internal xref">Appendix B</a>. Finally, please delete this note.<a href="#section-1.1-11" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-workflow">
<section id="section-2">
      <h2 id="name-the-short-distribution-chai">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-the-short-distribution-chai" class="section-name selfRef">The Short Distribution Chain (SDC) Workflow</a>
      </h2>
<p id="section-2-1">As defined in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-4" class="relref">Section 4</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>, the ACE framework relies on its basic protocol workflow shown in <a href="#fig-old-workflow" class="auto internal xref">Figure 1</a>.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">That is, the client first sends an access token request to the token endpoint at the AS (Step A), specifying permissions that it seeks to obtain for accessing protected resources at the RS, possibly together with information on its own public authentication credential.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">Then, if the request is successfully verified, authenticated, and authorized, the AS replies to the client with an access token response (Step B), providing an access token and possibly additional parameters as access information including the actually granted permissions.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">Finally, the client uploads the access token to the RS and, consistently with the permissions granted according to the access token, accesses a resource at the RS (Step C), which replies with the result of the resource access (Step F). Details about what protocol the client and the RS use to establish a secure association, mutually authenticate, and secure their communications are defined in the specific profile of ACE used, e.g., <span>[<a href="#RFC9202" class="cite xref">RFC9202</a>]</span><span>[<a href="#RFC9203" class="cite xref">RFC9203</a>]</span><span>[<a href="#RFC9431" class="cite xref">RFC9431</a>]</span><span>[<a href="#I-D.ietf-ace-edhoc-oscore-profile" class="cite xref">I-D.ietf-ace-edhoc-oscore-profile</a>]</span><span>[<a href="#I-D.ietf-ace-group-oscore-profile" class="cite xref">I-D.ietf-ace-group-oscore-profile</a>]</span>.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">Further interactions are possible between the AS and the RS, i.e., the exchange of an introspection request and response where the AS validates a previously issued access token for the RS (Steps D and E).<a href="#section-2-5" class="pilcrow">¶</a></p>
<span id="name-ace-basic-protocol-workflow"></span><div id="fig-old-workflow">
<figure id="figure-1">
        <div class="alignLeft art-text artwork" id="section-2-6.1">
<pre>
+--------+                               +---------------+
|        |---(A)-- Token Request -------&gt;|               |
|        |                               | Authorization |
|        |&lt;--(B)-- Access Token ---------|    Server     |
|        |    + Access Information       |               |
|        |    + Refresh Token (optional) +---------------+
|        |                                      ^ |
|        |            Introspection Request  (D)| |
| Client |                         Response     | |(E)
|        |            (optional exchange)       | |
|        |                                      | v
|        |                               +--------------+
|        |---(C)-- Token + Request -----&gt;|              |
|        |                               |   Resource   |
|        |&lt;--(F)-- Protected Resource ---|    Server    |
|        |                               |              |
+--------+                               +--------------+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-ace-basic-protocol-workflow" class="selfRef">ACE Basic Protocol Workflow.</a>
        </figcaption></figure>
</div>
<p id="section-2-7">This section defines the alternative Short Distribution Chain (SDC) workflow shown in <a href="#fig-new-workflow" class="auto internal xref">Figure 2</a>, which <span class="bcp14">MAY</span> be supported by the AS. Unlike in the original workflow defined in <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>, the AS uploads the access token to the RS on behalf of the client and then informs the client about the outcome.<a href="#section-2-7" class="pilcrow">¶</a></p>
<p id="section-2-8">If the token uploading has been successfully completed, the client typically does not need to obtain the access token from the AS altogether. That is, the client simply establishes a secure association with the RS (if that has not happened already) and then accesses protected resources at the RS, according to the permissions granted per the access token and specified by the AS as access information.<a href="#section-2-8" class="pilcrow">¶</a></p>
<span id="name-ace-short-distribution-chai"></span><div id="fig-new-workflow">
<figure id="figure-2">
        <div class="alignLeft art-text artwork" id="section-2-9.1">
<pre>
+--------+                               +----------------------------+
|        |---(A)-- Token Request -------&gt;|                            |
|        |                               |       Authorization        |
|        |&lt;--(B)-- Token Response -------|           Server           |
|        |    + Access Information       |                            |
|        |    + Access Token (optional)  +----------------------------+
|        |    + Refresh Token (optional)   ^ |         | ^
|        |                                 | |         | | Token-Upload
|        |        Introspection Request (D)| |     (A1)| |      Request
| Client |                     Response    | |(E)      | |(A2) Response
|        |        (optional exchange)      | |         | |
|        |                                 | v         v |
|        |                               +----------------------------+
|        |---(C1)-- Token (Optional) ---&gt;|                            |
|        |                               |                            |
|        |---(C2)-- Protected Request --&gt;|          Resource          |
|        |                               |           Server           |
|        |&lt;--(F)--- Protected Resource --|                            |
|        |                               |                            |
+--------+                               +----------------------------+
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-ace-short-distribution-chai" class="selfRef">ACE Short Distribution Chain (SDC) Workflow.</a>
        </figcaption></figure>
</div>
<p id="section-2-10">More specifically, the SDC workflow consists of the following steps.<a href="#section-2-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-11.1">
          <p id="section-2-11.1.1">Step A - Like in the original workflow, the client sends an access token request to the token endpoint at the AS, with the additional indication that it opts in to use the SDC workflow.<a href="#section-2-11.1.1" class="pilcrow">¶</a></p>
<p id="section-2-11.1.2">
As defined in <a href="#sec-token_upload" class="auto internal xref">Section 3.1</a>, this indication is provided to the AS by means of the "token_upload" parameter included in the access token request. The parameter also specifies what the AS has to return in the access token response at Step B, following a successful uploading of the access token from the AS to the RS.<a href="#section-2-11.1.2" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-11.2">
          <p id="section-2-11.2.1">Step A1 - This new step consists of the AS uploading the access token to the RS, typically at the authz-info endpoint, just like the client does in the original workflow.<a href="#section-2-11.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-11.3">
          <p id="section-2-11.3.1">Step A2 - This new step consists of the RS replying to the AS, following the uploading of the access token at Step A1.<a href="#section-2-11.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-11.4">
          <p id="section-2-11.4.1">Step B - In the access token response, the AS informs the client that it has attempted to upload the access token to the RS, specifying the outcome of the token uploading based on the reply received from the RS at Step A2.<a href="#section-2-11.4.1" class="pilcrow">¶</a></p>
<p id="section-2-11.4.2">
As defined in <a href="#sec-token_upload" class="auto internal xref">Section 3.1</a>, this information is provided to the client by means of the "token_upload" parameter included in the access token response. If the token uploading has failed, the access token response also includes the access token. Otherwise, the access token response includes information consistent with what was specified by the "token_upload" parameter of the access token request at Step A.<a href="#section-2-11.4.2" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-11.5">
          <p id="section-2-11.5.1">Step C1 - This step occurs only if the token uploading from the AS has failed, and the AS has provided the client with the access token at Step B. In such a case, the client uploads the access token to the RS just like at Step C of the original workflow.<a href="#section-2-11.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-11.6">
          <p id="section-2-11.6.1">Step C2 - The client attempts to access a protected resource at the RS, according to the permissions granted per the access token and specified by the AS as access information at Step B.<a href="#section-2-11.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-11.7">
          <p id="section-2-11.7.1">Steps D, E, and F are like in the original workflow.<a href="#section-2-11.7.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-2-12">The SDC workflow has no ambition to replace the original workflow defined in <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. The AS can use one workflow or the other, depending, for example, on the specific RS for which the access token has been issued and the nature of the communication leg with that RS.<a href="#section-2-12" class="pilcrow">¶</a></p>
<p id="section-2-13">When using the SDC workflow, all the communications between the AS and the RS <span class="bcp14">MUST</span> be protected, consistent with Sections <a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.4.3" class="relref">5.8.4.3</a> and <a href="https://rfc-editor.org/rfc/rfc9200#section-6.5" class="relref">6.5</a> of <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. Unlike in the original workflow, this results in protecting also the uploading of the first access token in a token series, i.e., in addition to the uploading of the following access tokens in the token series for dynamically updating the access rights of the client.<a href="#section-2-13" class="pilcrow">¶</a></p>
<p id="section-2-14">The SDC workflow is also suitable for deployments where clients are not aware of details such as the need for access tokens to be issued by the AS and uploaded at the RS. Consistent with the intended access policies, the AS can be configured to automatically issue access tokens for such clients and upload those access tokens to the RS. This means that such clients do not have to request for an access token to be issued in the first place. That is, they can immediately send requests to the RS for accessing its protected resources, in accordance with the access tokens already issued and uploaded by the AS.<a href="#section-2-14" class="pilcrow">¶</a></p>
<div id="sec-as-token-upload">
<section id="section-2.1">
        <h3 id="name-token-upload">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-token-upload" class="section-name selfRef">Token Upload</a>
        </h3>
<p id="section-2.1-1">When using the original workflow defined in <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>, there are two typical cases concerning the upload of the access token to the RS from C.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-2.1">
            <p id="section-2.1-2.1.1">The first case considers the upload of the first access token in a token series. While details depend on the specific profile of ACE used, such an access token is typically uploaded through an unprotected POST request to the authz-info endpoint.<a href="#section-2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-2.2">
            <p id="section-2.1-2.2.1">The second case considers the upload of an access token that is not the first in its token series, i.e., the AS has issued the access token for dynamically updating the access rights of C. The intent is also for C and the RS to preserve the same secure communication association that they currently share and that is associated with the token series in question.<a href="#section-2.1-2.2.1" class="pilcrow">¶</a></p>
<p id="section-2.1-2.2.2">
Such an access token is uploaded through a POST request to the authz-info endpoint, which is protected by means of the secure communication association that is shared between C and the RS. If the new access token is accepted by the RS, the new access token supersedes the one currently stored for the token series in question, and it becomes associated with the corresponding secure communication association that is shared between C and the RS.<a href="#section-2.1-2.2.2" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.1-3">However, if the AS uploads the access token to the RS on behalf of C as per the SDC workflow, the upload of the access token always rely on a protected POST request from the AS to the authz-info endpoint. In particular, the request is protected with the secure communication association shared between the AS and the RS.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1-4">When receiving a POST request to the authz-info endpoint that is specifically protected through the secure communication association shared with the AS, the RS proceeds as follows. In particular, the RS leverages the explicit indication provided by the AS through the "updated_rights" parameter defined in <a href="#sec-updated_rights" class="auto internal xref">Section 3.7</a>, which is included in the request in the case of dynamic update of access rights.<a href="#section-2.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-5.1">
            <p id="section-2.1-5.1.1">If the request does not include the "updated_rights" parameter, the RS processes the request and the access token therein like it would when receiving the request from C and according to the specific profile of ACE used. The access token in question is the first one in a token series.<a href="#section-2.1-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-5.2">
            <p id="section-2.1-5.2.1">If the request includes the "updated_rights" parameter encoding the CBOR simple value <code>true</code> (0xf5), then the access token in question, namely T_NEW, is not the first one in its token series, i.e., it is meant to dynamically update the access rights of C, while preserving the same secure communication association that is shared between C and the RS.<a href="#section-2.1-5.2.1" class="pilcrow">¶</a></p>
<p id="section-2.1-5.2.2">
In this case, the RS uses lookup information specified within T_NEW to determine whether it stores an access token T_OLD associated with C and belonging to the same token series of T_NEW. Such lookup information includes an identifier of the token series to which both T_NEW and T_OLD belong, and it can further comprise additional information elements pertaining to the specific profile of ACE used (e.g., the authentication credential of C that is bound to the access tokens of the token series).<a href="#section-2.1-5.2.2" class="pilcrow">¶</a></p>
<p id="section-2.1-5.2.3">
By leveraging such lookup information, the RS checks whether it stores an access token T_OLD that belongs to the same token series of T_NEW, like it would when receiving the request from C and according to the specific profile of ACE used.<a href="#section-2.1-5.2.3" class="pilcrow">¶</a></p>
<p id="section-2.1-5.2.4">
If the RS is currently storing such an old access token T_OLD and successfully validates the access token T_NEW, then the RS <span class="bcp14">MUST</span> supersede T_OLD by replacing the corresponding authorization information with the one specified in the new access token T_NEW. After that, the RS <span class="bcp14">MUST</span> associate T_NEW with the same secure communication association with which T_OLD was associated.<a href="#section-2.1-5.2.4" class="pilcrow">¶</a></p>
<p id="section-2.1-5.2.5">
If the RS is not currently storing such an old access token T_OLD, then the RS <span class="bcp14">MUST</span> reject the POST request from the AS and <span class="bcp14">MUST</span> reply with an error response that has a response code equivalent to the CoAP code 5.00 (Internal Server Error).<a href="#section-2.1-5.2.5" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.1-6">The explicit indication provided by the "updated_rights" parameter prevents possible ambiguous situations, where the RS might erroneously believe that an access token is the first one in a new token series (e.g., following the deletion of stored access tokens due to memory limitations).<a href="#section-2.1-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-parameters">
<section id="section-3">
      <h2 id="name-new-parameters">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-new-parameters" class="section-name selfRef">New Parameters</a>
      </h2>
<p id="section-3-1">The rest of this section defines a number of additional parameters and encodings for the OAuth 2.0 token endpoint at the AS (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8" class="relref">Section 5.8</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>) and for the OAuth 2.0 authz-info endpoint at the RS (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.10.1" class="relref">Section 5.10.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>).<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="sec-token_upload">
<section id="section-3.1">
        <h3 id="name-token_upload">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-token_upload" class="section-name selfRef">token_upload</a>
        </h3>
<p id="section-3.1-1">This section defines the additional "token_upload" parameter. The parameter can be used in an access token request sent by C to the token endpoint at the AS (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.1" class="relref">Section 5.8.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>), as well as in the access token response sent as a reply by the AS (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.2" class="relref">Section 5.8.2</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>).<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.1">
            <p id="section-3.1-2.1.1">The "token_upload" parameter is <span class="bcp14">OPTIONAL</span> in an access token request. The presence of this parameter indicates that C opts in to use the SDC workflow defined in <a href="#sec-workflow" class="auto internal xref">Section 2</a>, whose actual use for uploading the issued access token to the RS is an exclusive prerogative of the AS.<a href="#section-3.1-2.1.1" class="pilcrow">¶</a></p>
<p id="section-3.1-2.1.2">
This parameter can take one of the following integer values. When the access token request is encoded in CBOR, those values are encoded as CBOR unsigned integers. The value of the parameter determines whether the follow-up access token response will have to include certain information, in case the AS has successfully uploaded the access token to the RS.<a href="#section-3.1-2.1.2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.1.3.1">
                <p id="section-3.1-2.1.3.1.1">0: The access token response will have to include neither the access token nor its corresponding token hash.<a href="#section-3.1-2.1.3.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.1-2.1.3.2">
                <p id="section-3.1-2.1.3.2.1">1: The access token response will have to include the token hash corresponding to the access token, but not the access token.<a href="#section-3.1-2.1.3.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.1-2.1.3.3">
                <p id="section-3.1-2.1.3.3.1">2: The access token response will have to include the access token, but not the corresponding token hash.<a href="#section-3.1-2.1.3.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.1-2.1.4">
If the AS supports the SDC workflow and the access token request includes the "token_upload" parameter with value 0, 1, or 2, then the AS <span class="bcp14">MAY</span> use the SDC workflow to upload the access token to the RS on behalf of C. Otherwise, following that access token request, the AS <span class="bcp14">MUST NOT</span> use the SDC workflow.<a href="#section-3.1-2.1.4" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.2">
            <p id="section-3.1-2.2.1">The "token_upload" parameter is <span class="bcp14">REQUIRED</span> in an access token response, if both the following conditions apply. Otherwise, the "token_upload" parameter <span class="bcp14">MUST NOT</span> be present.<a href="#section-3.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.2.2.1">
                <p id="section-3.1-2.2.2.1.1">The corresponding access token request included the "token_upload" parameter, with value 0, 1, or 2.<a href="#section-3.1-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.1-2.2.2.2">
                <p id="section-3.1-2.2.2.2.1">The AS has attempted to upload the issued access token to the RS as per the SDC workflow, irrespective of the result of the token upload.<a href="#section-3.1-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.1-2.2.3">
When the "token_upload" parameter is present in the access token response, it can take one of the following integer values. When the access token response is encoded in CBOR, those values are encoded as CBOR unsigned integers.<a href="#section-3.1-2.2.3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.2.4.1">
                <p id="section-3.1-2.2.4.1.1">If the token upload to the RS was not successful, then the "token_upload" parameter <span class="bcp14">MUST</span> encode the value 1.<a href="#section-3.1-2.2.4.1.1" class="pilcrow">¶</a></p>
<p id="section-3.1-2.2.4.1.2">
In this case, the access token response <span class="bcp14">MUST</span> include the "access_token" parameter specifying the issued access token.<a href="#section-3.1-2.2.4.1.2" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.1-2.2.4.2">
                <p id="section-3.1-2.2.4.2.1">If the token upload at the RS was successful, then the "token_upload" parameter <span class="bcp14">MUST</span> encode the value 0.<a href="#section-3.1-2.2.4.2.1" class="pilcrow">¶</a></p>
<p id="section-3.1-2.2.4.2.2">
In this case, the access token response can include additional parameters as defined below, depending on the value of the "token_upload" parameter in the corresponding access token request.<a href="#section-3.1-2.2.4.2.2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.2.4.2.3.1">
                    <p id="section-3.1-2.2.4.2.3.1.1">If the "token_upload" parameter in the access token request specified the value 0, then the access token response <span class="bcp14">MUST NOT</span> include the "access_token" parameter and <span class="bcp14">MUST NOT</span> include the "token_hash" parameter defined in <a href="#sec-token_hash" class="auto internal xref">Section 3.2</a>.<a href="#section-3.1-2.2.4.2.3.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-3.1-2.2.4.2.3.2">
                    <p id="section-3.1-2.2.4.2.3.2.1">If the "token_upload" parameter in the access token request specified the value 1, then the access token response <span class="bcp14">MUST NOT</span> include the "access_token" parameter and <span class="bcp14">MUST</span> include the "token_hash" parameter defined in <a href="#sec-token_hash" class="auto internal xref">Section 3.2</a>, specifying the hash corresponding to the issued access token and computed as defined in <a href="#sec-token_hash" class="auto internal xref">Section 3.2</a>.<a href="#section-3.1-2.2.4.2.3.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-3.1-2.2.4.2.3.3">
                    <p id="section-3.1-2.2.4.2.3.3.1">If the "token_upload" parameter in the access token request specified the value 2, then the access token response <span class="bcp14">MUST</span> include the "access_token" parameter specifying the issued access token and <span class="bcp14">MUST NOT</span> include the "token_hash" parameter defined in <a href="#sec-token_hash" class="auto internal xref">Section 3.2</a>.<a href="#section-3.1-2.2.4.2.3.3.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
        </ul>
<div id="examples">
<section id="section-3.1.1">
          <h4 id="name-examples">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
          </h4>
<p id="section-3.1.1-1"><a href="#fig-example-AS-to-C-token-upload" class="auto internal xref">Figure 3</a> shows an example, with first an access token request from C to the AS and then an access token response from the AS to C, following the issue of an access token bound to a symmetric PoP key.<a href="#section-3.1.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1.1-2">The access token request specifies the "token_upload" parameter with value 0. That is, C indicates that it requires neither the access token nor the corresponding token hash from the AS, in case the AS successfully uploads the access token to the RS.<a href="#section-3.1.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1.1-3">The access token response specifies the "token_upload" parameter with value 0, which indicates that the AS has successfully uploaded the access token to the RS on behalf of C.<a href="#section-3.1.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1.1-4">Consistent with the value of the "token_upload" parameter in the access token request, the access token response includes neither the access token nor its corresponding token hash. The access token response also includes the "cnf" parameter specifying the symmetric PoP key bound to the access token.<a href="#section-3.1.1-4" class="pilcrow">¶</a></p>
<span id="name-example-of-access-token-req"></span><div id="fig-example-AS-to-C-token-upload">
<figure id="figure-3">
            <div class="alignLeft art-text artwork" id="section-3.1.1-5.1">
<pre>
   Access token request

   Header: POST (Code=0.02)
   Uri-Host: "as.example.com"
   Uri-Path: "token"
   Content-Format: 19 (application/ace+cbor)
   Payload:
   {
     / audience /  5 : "tempSensor4711",
     / scope /     9 : "read",
     e'token_upload' : 0
   }


   Access token response

   Header: Created (Code=2.01)
   Content-Format: 19 (application/ace+cbor)
   Max-Age: 3560
   Payload:
   {
      e'token_upload' : 0,
     / expires_in / 2 : 3600,
     / cnf /        8 : {
       / COSE_Key / 1 : {
         / kty / 1 : 4 / Symmetric /,
         / kid / 2 : h'3d027833fc6267ce',
         / k /  -1 : h'73657373696f6e6b6579'
       }
     }
   }
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-example-of-access-token-req" class="selfRef">Example of Access Token Request-Response Exchange. Following a successful uploading of the access token from the AS to the RS, the access token response includes the "token_upload" parameter but not the access token, which is bound to a symmetric key and was uploaded to the RS by the AS.</a>
            </figcaption></figure>
</div>
<p id="section-3.1.1-6"><a href="#fig-example-AS-to-C-token-upload-success-ret-token" class="auto internal xref">Figure 4</a> shows another example, with first an access token request from C to the AS and then an access token response from the AS to C, also following the issue of an access token bound to a symmetric PoP key.<a href="#section-3.1.1-6" class="pilcrow">¶</a></p>
<p id="section-3.1.1-7">The access token request specifies the "token_upload" parameter with value 2. That is, C indicates that it requires the access token from the AS, even in case the AS successfully uploads the access token to the RS.<a href="#section-3.1.1-7" class="pilcrow">¶</a></p>
<p id="section-3.1.1-8">The access token response specifies the "token_upload" parameter with value 0, which indicates that the AS has successfully uploaded the access token to the RS on behalf of C.<a href="#section-3.1.1-8" class="pilcrow">¶</a></p>
<p id="section-3.1.1-9">Consistent with the value of the "token_upload" parameter in the access token request, the access token response includes the "access_token" parameter specifying the issued access token. The access token response also includes the "cnf" parameter specifying the symmetric PoP key bound to the access token.<a href="#section-3.1.1-9" class="pilcrow">¶</a></p>
<span id="name-example-of-access-token-requ"></span><div id="fig-example-AS-to-C-token-upload-success-ret-token">
<figure id="figure-4">
            <div class="alignLeft art-text artwork" id="section-3.1.1-10.1">
<pre>
   Access token request

   Header: POST (Code=0.02)
   Uri-Host: "as.example.com"
   Uri-Path: "token"
   Content-Format: 19 (application/ace+cbor)
   Payload:
   {
     / audience /  5 : "tempSensor4711",
     / scope /     9 : "read",
     e'token_upload' : 2
   }


   Access token response

   Header: Created (Code=2.01)
   Content-Format: 19 (application/ace+cbor)
   Max-Age: 3560
   Payload:
   {
        e'token_upload' : 0,
     / access_token / 1 : h'd08343a1...4819',
       / (full CWT elided for brevity;
          CWT contains the symmetric PoP key in the "cnf" claim) /
     / expires_in /   2 : 3600,
     / cnf /          8 : {
       / COSE_Key / 1 : {
         / kty / 1 : 4 / Symmetric /,
         / kid / 2 : h'3d027833fc6267ce',
         / k /  -1 : h'73657373696f6e6b6579'
       }
     }
   }
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-example-of-access-token-requ" class="selfRef">Example of Access Token Request-Response Exchange. Following a successful uploading of the access token from the AS to the RS, the access token response includes the "token_upload" parameter as well as the "access_token" parameter conveying the access token, which is bound to a symmetric key and was uploaded to the RS by the AS.</a>
            </figcaption></figure>
</div>
<p id="section-3.1.1-11"><a href="#fig-example-AS-to-C-token-upload-failed" class="auto internal xref">Figure 5</a> shows another example, with first an access token request from C to the AS and then an access token response from the AS to C, also following the issue of an access token bound to a symmetric PoP key.<a href="#section-3.1.1-11" class="pilcrow">¶</a></p>
<p id="section-3.1.1-12">The access token request specifies the "token_upload" parameter with value 0. That is, C indicates that it requires neither the access token nor the corresponding token hash from the AS, in case the AS successfully uploads the access token to the RS.<a href="#section-3.1.1-12" class="pilcrow">¶</a></p>
<p id="section-3.1.1-13">In this example, the access token response includes the "token_upload" parameter with value 1, which indicates that the AS has attempted and failed to upload the access token to the RS on behalf of C. The access token response also includes the "access_token" parameter specifying the issued access token, together with the "cnf" parameter specifying the symmetric PoP key bound to the access token.<a href="#section-3.1.1-13" class="pilcrow">¶</a></p>
<p id="section-3.1.1-14">Note that, even though the AS has failed to upload the access token to the RS, the response code 2.01 (Created) is used when replying to C, since the access token request as such has been successfully processed at the AS, with the following issue of the access token.<a href="#section-3.1.1-14" class="pilcrow">¶</a></p>
<span id="name-example-of-access-token-reque"></span><div id="fig-example-AS-to-C-token-upload-failed">
<figure id="figure-5">
            <div class="alignLeft art-text artwork" id="section-3.1.1-15.1">
<pre>
   Access token request

   Header: POST (Code=0.02)
   Uri-Host: "as.example.com"
   Uri-Path: "token"
   Content-Format: 19 (application/ace+cbor)
   Payload:
   {
     / audience /  5 : "tempSensor4711",
     / scope /     9 : "read",
     e'token_upload' : 0
   }


   Access token response

   Header: Created (Code=2.01)
   Content-Format: 19 (application/ace+cbor)
   Max-Age: 3560
   Payload:
   {
        e'token_upload' : 1,
     / access_token / 1 : h'd08343a1...4819',
       / (full CWT elided for brevity;
          CWT contains the symmetric PoP key in the "cnf" claim) /
     / expires_in /   2 : 3600,
     / cnf /          8 : {
       / COSE_Key / 1 : {
         / kty / 1 : 4 / Symmetric /,
         / kid / 2 : h'3d027833fc6267ce',
         / k /  -1 : h'73657373696f6e6b6579'
       }
     }
   }
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-example-of-access-token-reque" class="selfRef">Example of Access Token Request-Response Exchange. Following a failed uploading of the access token from the AS to the RS, the access token response includes the "token_upload" parameter with value 1 as well the "access_token" parameter conveying the access token bound to a symmetric key.</a>
            </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="sec-token_hash">
<section id="section-3.2">
        <h3 id="name-token_hash">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-token_hash" class="section-name selfRef">token_hash</a>
        </h3>
<p id="section-3.2-1">This section defines the additional "token_hash" parameter. The parameter can be used in an access token response sent by the AS (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.2" class="relref">Section 5.8.2</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>), in reply to an access token request sent to the token endpoint by C.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">The following refers to the base64url encoding without padding (see <span><a href="https://rfc-editor.org/rfc/rfc4648#section-5" class="relref">Section 5</a> of [<a href="#RFC4648" class="cite xref">RFC4648</a>]</span>) and denotes as "binary representation" of a text string the corresponding UTF-8 encoding <span>[<a href="#RFC3629" class="cite xref">RFC3629</a>]</span>, which is the implied charset used in JSON (see <span><a href="https://rfc-editor.org/rfc/rfc8259#section-8.1" class="relref">Section 8.1</a> of [<a href="#RFC8259" class="cite xref">RFC8259</a>]</span>).<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">The "token_hash" parameter is <span class="bcp14">REQUIRED</span> in an access token response, if both the following conditions apply. Otherwise, the "token_hash" parameter <span class="bcp14">MUST NOT</span> be present.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-4.1">
            <p id="section-3.2-4.1.1">The corresponding access token request included the "token_upload" parameter with value 1.<a href="#section-3.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-4.2">
            <p id="section-3.2-4.2.1">The access token response includes the "token_upload" parameter with value 0. That is, the AS has successfully uploaded the issued access token to the RS, as per the SDC workflow.<a href="#section-3.2-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.2-5">This parameter specifies the token hash corresponding to the access token issued by the AS and successfully uploaded to the RS on behalf of C. In particular:<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-6.1">
            <p id="section-3.2-6.1.1">If the access token response is encoded in CBOR, then the "token_hash" parameter is a CBOR byte string, with value the token hash.<a href="#section-3.2-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-6.2">
            <p id="section-3.2-6.2.1">If the access token response is encoded in JSON, then the "token_hash" parameter has as value the base64url-encoded text string that encodes the token hash.<a href="#section-3.2-6.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.2-7">The AS computes the token hash as defined in <a href="#sec-token-hash-output" class="auto internal xref">Section 3.2.1</a>.<a href="#section-3.2-7" class="pilcrow">¶</a></p>
<div id="sec-token-hash-output">
<section id="section-3.2.1">
          <h4 id="name-computing-the-token-hash">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-computing-the-token-hash" class="section-name selfRef">Computing the Token Hash</a>
          </h4>
<p id="section-3.2.1-1">The AS computes the token hash over the value that the "access_token" parameter would have had in the same access token response, if it was included therein and specifying the access token.<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1-2">In particular, the input HASH_INPUT over which the token hash is computed is determined as follows.<a href="#section-3.2.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1-3.1">
              <p id="section-3.2.1-3.1.1">If the access token response is encoded in CBOR, then:<a href="#section-3.2.1-3.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1-3.1.2.1">
                  <p id="section-3.2.1-3.1.2.1.1">BYTES denotes the value of the CBOR byte string that would be conveyed by the "access_token" parameter, if this was included in the access token response.<a href="#section-3.2.1-3.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.1-3.1.2.2">
                  <p id="section-3.2.1-3.1.2.2.1">HASH_INPUT_TEXT is the base64url-encoded text string that encodes BYTES.<a href="#section-3.2.1-3.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.1-3.1.2.3">
                  <p id="section-3.2.1-3.1.2.3.1">HASH_INPUT is the binary representation of HASH_INPUT_TEXT.<a href="#section-3.2.1-3.1.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-3.2.1-3.2">
              <p id="section-3.2.1-3.2.1">If the access token response is encoded in JSON, then HASH_INPUT is the binary representation of the text string conveyed by the "access_token" parameter, if this was included in the access token response.<a href="#section-3.2.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.2.1-4">Once determined HASH_INPUT as defined above, a hash value of HASH_INPUT is generated as per <span><a href="https://rfc-editor.org/rfc/rfc6920#section-6" class="relref">Section 6</a> of [<a href="#RFC6920" class="cite xref">RFC6920</a>]</span>. The resulting output in binary format is used as the token hash. Note that the used binary format embeds the identifier of the used hash function in the first byte of the computed token hash.<a href="#section-3.2.1-4" class="pilcrow">¶</a></p>
<p id="section-3.2.1-5">The specific hash function used <span class="bcp14">MUST</span> be collision resistant on byte strings and <span class="bcp14">MUST</span> be selected from the "Named Information Hash Algorithm Registry" <span>[<a href="#IANA.Hash.Algorithms" class="cite xref">IANA.Hash.Algorithms</a>]</span>. Consistent with the compliance requirements in <span><a href="https://rfc-editor.org/rfc/rfc6920#section-2" class="relref">Section 2</a> of [<a href="#RFC6920" class="cite xref">RFC6920</a>]</span>, the hash function sha-256 as specified in <span>[<a href="#SHA-256" class="cite xref">SHA-256</a>]</span> is mandatory to implement.<a href="#section-3.2.1-5" class="pilcrow">¶</a></p>
<p id="section-3.2.1-6">The computation of token hashes defined above is aligned with that specified for the computation of token hashes in <span><a href="https://rfc-editor.org/rfc/rfc9770#section-4" class="relref">Section 4</a> of [<a href="#RFC9770" class="cite xref">RFC9770</a>]</span>, where they are used as identifiers of revoked access tokens. Therefore, given a hash algorithm and an access token, the AS computes the same corresponding token hash in either case.<a href="#section-3.2.1-6" class="pilcrow">¶</a></p>
<p id="section-3.2.1-7">If the AS supports the method specified in <span>[<a href="#RFC9770" class="cite xref">RFC9770</a>]</span>, then the AS <span class="bcp14">MUST</span> use the same hash algorithm for computing both the token hashes to include in the "token_hash" parameter and the token hashes computed per that method to identify revoked access tokens.<a href="#section-3.2.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="example">
<section id="section-3.2.2">
          <h4 id="name-example">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-example" class="section-name selfRef">Example</a>
          </h4>
<p id="section-3.2.2-1"><a href="#fig-example-AS-to-C-token-hash" class="auto internal xref">Figure 6</a> shows an example, with first an access token request from C to the AS and then an access token response from the AS to C, following the issue of an access token bound to a symmetric PoP key.<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2.2-2">The access token request specifies the "token_upload" parameter with value 1. That is, C indicates that it requires the token hash corresponding to the access token from the AS, in case the AS successfully uploads the access token to the RS.<a href="#section-3.2.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2.2-3">The access token response specifies the "token_upload" parameter with value 0, which indicates that the AS has successfully uploaded the access token to the RS on behalf of C.<a href="#section-3.2.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2.2-4">Consistent with the value of the "token_upload" parameter in the access token request, the access token response includes the "token_hash" parameter, which specifies the token hash corresponding to the issued access token. The access token response also includes the "cnf" parameter specifying the symmetric PoP key bound to the access token.<a href="#section-3.2.2-4" class="pilcrow">¶</a></p>
<span id="name-example-of-access-token-reques"></span><div id="fig-example-AS-to-C-token-hash">
<figure id="figure-6">
            <div class="alignLeft art-text artwork" id="section-3.2.2-5.1">
<pre>
   Access token request

   Header: POST (Code=0.02)
   Uri-Host: "as.example.com"
   Uri-Path: "token"
   Content-Format: 19 (application/ace+cbor)
   Payload:
   {
     / audience /  5 : "tempSensor4711",
     / scope /     9 : "read",
     e'token_upload' : 1
   }


   Access token response

   Header: Created (Code=2.01)
   Content-Format: 19 (application/ace+cbor)
   Max-Age: 3560
   Payload:
   {
      e'token_upload' : 0,
        e'token_hash' : h'0153269057e12fe2b74ba07c892560a2d7
                          53877eb62ff44d5a19002530ed97ffe4',
     / expires_in / 2 : 3600,
     / cnf /        8 : {
       / COSE_Key / 1 : {
         / kty / 1 : 4 / Symmetric /,
         / kid / 2 : h'3d027833fc6267ce',
         / k /  -1 : h'73657373696f6e6b6579'
       }
     }
   }
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-example-of-access-token-reques" class="selfRef">Example of Access Token Request-Response Exchange. Following a successful uploading of the access token from the AS to the RS, the access token response includes the "token_upload" parameter as well as the "token_hash" parameter. The "token_hash" parameter conveys the token hash corresponding to the issued access token, which is bound to a symmetric key and was uploaded to the RS by the AS.</a>
            </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="sec-to_rs-from_rs">
<section id="section-3.3">
        <h3 id="name-to_rs-and-from_rs">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-to_rs-and-from_rs" class="section-name selfRef">to_rs and from_rs</a>
        </h3>
<p id="section-3.3-1">The rest of this section defines the additional parameters "to_rs" (see <a href="#sec-to_rs" class="auto internal xref">Section 3.3.1</a>) and "from_rs" (see <a href="#sec-from_rs" class="auto internal xref">Section 3.3.2</a>).<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">The "to_rs" parameter can be used in an access token request sent by C to the token endpoint at the AS (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.1" class="relref">Section 5.8.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>). The "from_rs" parameter can be used in an access token response sent by the AS (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.2" class="relref">Section 5.8.2</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>), in reply to an access token request sent to the token endpoint by C.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">The semantics and encoding of the information specified in the two parameters depend on the specific profile of ACE and application used.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">For instance, when using the OSCORE profile <span>[<a href="#RFC9203" class="cite xref">RFC9203</a>]</span>, C and RS can use the two parameters to exchange the expected nonces and identifiers via the AS. <a href="#sec-to_rs-from_rs-oscore-profile" class="auto internal xref">Section 3.3.3</a> describes how the two parameters are used when the OSCORE profile is used, thereby effectively enabling the use of the SDC workflow for that profile.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<div id="sec-to_rs">
<section id="section-3.3.1">
          <h4 id="name-to_rs">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-to_rs" class="section-name selfRef">to_rs</a>
          </h4>
<p id="section-3.3.1-1">The "to_rs" parameter is <span class="bcp14">OPTIONAL</span> in an access token request. The presence of this parameter indicates that:<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.1-2.1">
              <p id="section-3.3.1-2.1.1">C wishes the AS to relay the information specified therein to the RS, when the AS uploads the issued access token to the RS per the SDC workflow defined in <a href="#sec-workflow" class="auto internal xref">Section 2</a>; and<a href="#section-3.3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.3.1-2.2">
              <p id="section-3.3.1-2.2.1">C wishes the AS to relay information received from the RS to C, after having successfully uploaded the access token to the RS per the SDC workflow defined in <a href="#sec-workflow" class="auto internal xref">Section 2</a>.<a href="#section-3.3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.3.1-3">This parameter <span class="bcp14">MUST NOT</span> be present if the "token_upload" parameter defined in <a href="#sec-token_upload" class="auto internal xref">Section 3.1</a> is not present in the access token request. Also, this parameter <span class="bcp14">MUST NOT</span> be present if the requested access token is not the first one of a new token series, i.e., if C is asking the AS for a new access token in the same token series that dynamically updates access rights.<a href="#section-3.3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.3.1-4">If C wishes that the AS relays information from the RS after successfully uploading the access token but C does not have any information to be relayed to the RS, then this parameter <span class="bcp14">MUST</span> encode the CBOR simple value <code>null</code> (0xf6).<a href="#section-3.3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.3.1-5">Otherwise, this parameter specifies the information that C wishes the AS to relay to the RS, when uploading the access token to the RS on behalf of C.<a href="#section-3.3.1-5" class="pilcrow">¶</a></p>
<p id="section-3.3.1-6">Such information consists in what C would provide to the RS in addition to the access token, by sending a POST request to the authz-info endpoint in case the original workflow was used.<a href="#section-3.3.1-6" class="pilcrow">¶</a></p>
<p id="section-3.3.1-7">When composing the parameter "to_rs", C considers the same information and <span class="bcp14">MUST</span> wrap it in a data structure STRUCT, by using the same method that it employs when using the original workflow. For example, with reference to the OSCORE profile of ACE <span>[<a href="#RFC9203" class="cite xref">RFC9203</a>]</span>, such a method composes STRUCT as a CBOR map, which has to be sent as payload of a request with Content-Format "application/ace+cbor".<a href="#section-3.3.1-7" class="pilcrow">¶</a></p>
<p id="section-3.3.1-8">After that, C builds a CBOR byte string STR, whose value is the binary representation of STRUCT.<a href="#section-3.3.1-8" class="pilcrow">¶</a></p>
<p id="section-3.3.1-9">If and only if the request to the authz-info endpoint has to be sent with a Content-Format ct different from the one employed in the profile of ACE used, then C <span class="bcp14">MUST</span> tag the CBOR byte string STR (see <span><a href="https://rfc-editor.org/rfc/rfc8949#section-3.4" class="relref">Section 3.4</a> of [<a href="#RFC8949" class="cite xref">RFC8949</a>]</span>). The tag number TN <span class="bcp14">MUST</span> be the one associated with the Content-Format ct and is determined according to the technique described in <span><a href="https://rfc-editor.org/rfc/rfc9277#appendix-B" class="relref">Appendix B</a> of [<a href="#RFC9277" class="cite xref">RFC9277</a>]</span>. For example, the Content-Format "application/ace+cbor" has Content-Format ID 19 and therefore has 1668546836 as its associated tag number.<a href="#section-3.3.1-9" class="pilcrow">¶</a></p>
<p id="section-3.3.1-10">When the access token request is encoded in CBOR, the value of the "to_rs" parameter is the (tagged) CBOR byte string STR.<a href="#section-3.3.1-10" class="pilcrow">¶</a></p>
<p id="section-3.3.1-11">When the access token request is encoded in JSON, the value of the "to_rs" parameter is a text string, which encodes the binary representation of the (tagged) CBOR byte string STR in base64url without padding (see <span><a href="https://rfc-editor.org/rfc/rfc4648#section-5" class="relref">Section 5</a> of [<a href="#RFC4648" class="cite xref">RFC4648</a>]</span>).<a href="#section-3.3.1-11" class="pilcrow">¶</a></p>
<p id="section-3.3.1-12">If the "to_rs" parameter is present and specifies a value different from the CBOR simple value <code>null</code> (0xf6), the AS proceeds as follows when composing the POST request to send to the authz-info endpoint on behalf of C:<a href="#section-3.3.1-12" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.3.1-13">
<li id="section-3.3.1-13.1">
              <p id="section-3.3.1-13.1.1">The AS sets the Content-Format of the request to be either:<a href="#section-3.3.1-13.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.1-13.1.2.1">
                  <p id="section-3.3.1-13.1.2.1.1">the one employed in the profile of ACE used, if the CBOR byte string STR conveyed by the "to_rs" parameter is not tagged; or, otherwise,<a href="#section-3.3.1-13.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.3.1-13.1.2.2">
                  <p id="section-3.3.1-13.1.2.2.1">the one associated with the tag number TN of the tagged CBOR byte string STR conveyed by the "to_rs" parameter.<a href="#section-3.3.1-13.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li id="section-3.3.1-13.2">
              <p id="section-3.3.1-13.2.1">The AS retrieves the structure STRUCT from STR and extends STRUCT by adding the issued access token, consistently with the profile of ACE used and the Content-Format determined at the previous step.<a href="#section-3.3.1-13.2.1" class="pilcrow">¶</a></p>
<p id="section-3.3.1-13.2.2">
For example, when using the OSCORE profile of ACE <span>[<a href="#RFC9203" class="cite xref">RFC9203</a>]</span> and thus the Content-Format to use is "application/ace+cbor", STRUCT is a CBOR map and the access token is included therein as an entry that has: as map key, 1 encoded as a CBOR integer; as map value, a CBOR byte string whose value is the binary representation of the access token.<a href="#section-3.3.1-13.2.2" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-3.3.1-14">Clearly, performing the two steps above requires the AS to understand the structure STRUCT and its semantics. In turn, such an understanding builds on the AS supporting the profile of ACE used and the Content-Format to use as determined at Step 1. In the expected cases, the AS is realistically able to perform the two steps. If the AS finds itself unable to perform the two steps, then the AS would simply not upload the access token to the RS on behalf of C. In such a case, the AS replies to C with an access token response, which includes the "access_token" parameter specifying the issued access token and does not include the "token_upload" parameter (see <a href="#sec-token_upload" class="auto internal xref">Section 3.1</a>).<a href="#section-3.3.1-14" class="pilcrow">¶</a></p>
<p id="section-3.3.1-15">Tagging the CBOR byte string as defined above ensures that the AS can relay the information specified in the "to_rs" parameter as intended by C, i.e., by sending to the authz-info endpoint a POST request that has the correct Content-Format and conveys the correct payload.<a href="#section-3.3.1-15" class="pilcrow">¶</a></p>
<p id="section-3.3.1-16">As a case in point, using the DTLS profile of ACE <span>[<a href="#RFC9202" class="cite xref">RFC9202</a>]</span> typically results in a POST request to the authz-info endpoint with Content-Format "application/cwt", as per <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.10" class="relref">Section 5.10</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>. However, the DTLS profile of ACE can be combined with application profiles of <span>[<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>. In such a case, the POST request might convey both the access token and additional parameters from C (e.g., "sign_info" defined in <span><a href="https://rfc-editor.org/rfc/rfc9594#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>), which requires the request to have Content-Format "application/ace+cbor" (see <span><a href="https://rfc-editor.org/rfc/rfc9594#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>).<a href="#section-3.3.1-16" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-from_rs">
<section id="section-3.3.2">
          <h4 id="name-from_rs">
<a href="#section-3.3.2" class="section-number selfRef">3.3.2. </a><a href="#name-from_rs" class="section-name selfRef">from_rs</a>
          </h4>
<p id="section-3.3.2-1">The "from_rs" parameter is <span class="bcp14">OPTIONAL</span> in an access token response. The presence of this parameter indicates that the AS is relaying the information specified therein to C, which the AS has received from the RS after having successfully uploaded the access token to the RS per the SDC workflow defined in <a href="#sec-workflow" class="auto internal xref">Section 2</a>.<a href="#section-3.3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.3.2-2">This parameter <span class="bcp14">MUST</span> be present if and only if both the following conditions apply:<a href="#section-3.3.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.2-3.1">
              <p id="section-3.3.2-3.1.1">The "token_upload" parameter defined in <a href="#sec-token_upload" class="auto internal xref">Section 3.1</a> is present with value 0 in the access token response.<a href="#section-3.3.2-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.3.2-3.2">
              <p id="section-3.3.2-3.2.1">The "to_rs" parameter was present in the access token request corresponding to the access token response.<a href="#section-3.3.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.3.2-4">This parameter specifies the information that the AS is relaying to C from the RS, following the successful upload of the access token to the RS on behalf of C.<a href="#section-3.3.2-4" class="pilcrow">¶</a></p>
<p id="section-3.3.2-5">Such information consists in what C would receive in a successful response from the authz-info endpoint, if the access token was uploaded per the original workflow.<a href="#section-3.3.2-5" class="pilcrow">¶</a></p>
<p id="section-3.3.2-6">When composing the parameter "from_rs", the AS builds a CBOR byte string STR as follows:<a href="#section-3.3.2-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.2-7.1">
              <p id="section-3.3.2-7.1.1">If the successful response from the authz-info endpoint does not include a payload, then STR is the empty CBOR byte string (0x40); otherwise,<a href="#section-3.3.2-7.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.3.2-7.2">
              <p id="section-3.3.2-7.2.1">The value of STR is the payload of the successful response from the authz-info endpoint.<a href="#section-3.3.2-7.2.1" class="pilcrow">¶</a></p>
<p id="section-3.3.2-7.2.2">
If and only if the response specifies a given Content-Format ct (i.e., by means of the CoAP Content-Format Option), then the AS <span class="bcp14">MUST</span> tag the CBOR byte string STR (see <span><a href="https://rfc-editor.org/rfc/rfc8949#section-3.4" class="relref">Section 3.4</a> of [<a href="#RFC8949" class="cite xref">RFC8949</a>]</span>). The tag number TN <span class="bcp14">MUST</span> be the one associated with the Content-Format ct and is determined according to the technique described in <span><a href="https://rfc-editor.org/rfc/rfc9277#appendix-B" class="relref">Appendix B</a> of [<a href="#RFC9277" class="cite xref">RFC9277</a>]</span>.<a href="#section-3.3.2-7.2.2" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.3.2-8">When the access token response is encoded in CBOR, the value of the "from_rs" parameter is the (tagged) CBOR byte string STR.<a href="#section-3.3.2-8" class="pilcrow">¶</a></p>
<p id="section-3.3.2-9">When the access token response is encoded in JSON, the value of the "from_rs" parameter is a text string, which encodes the binary representation of the (tagged) CBOR byte string STR in base64url without padding (see <span><a href="https://rfc-editor.org/rfc/rfc4648#section-5" class="relref">Section 5</a> of [<a href="#RFC4648" class="cite xref">RFC4648</a>]</span>).<a href="#section-3.3.2-9" class="pilcrow">¶</a></p>
<p id="section-3.3.2-10">When C receives from the AS the access token response specifying the "token_upload" parameter with value 0, C retrieves from the "from_rs" parameter the information relayed by the AS, just like when retrieving that information from a successful response with Content-Format ct that C receives from the RS when using the original workflow.<a href="#section-3.3.2-10" class="pilcrow">¶</a></p>
<p id="section-3.3.2-11">In particular, if the CBOR byte string STR is not the empty CBOR byte string (0x40), C considers as the Content-Format ct either:<a href="#section-3.3.2-11" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.2-12.1">
              <p id="section-3.3.2-12.1.1">the one employed in the profile of ACE used, if the CBOR byte string STR conveyed by the "from_rs" parameter is not tagged; or, otherwise,<a href="#section-3.3.2-12.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.3.2-12.2">
              <p id="section-3.3.2-12.2.1">the one associated with the tag number TN of the tagged CBOR byte string STR conveyed by the "from_rs" parameter.<a href="#section-3.3.2-12.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="sec-to_rs-from_rs-oscore-profile">
<section id="section-3.3.3">
          <h4 id="name-use-with-the-oscore-profile">
<a href="#section-3.3.3" class="section-number selfRef">3.3.3. </a><a href="#name-use-with-the-oscore-profile" class="section-name selfRef">Use with the OSCORE Profile</a>
          </h4>
<p id="section-3.3.3-1">This section describes how to use the parameters "to_rs" and "from_rs" when the OSCORE profile of ACE <span>[<a href="#RFC9203" class="cite xref">RFC9203</a>]</span> is used.<a href="#section-3.3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3.3-2">Within the access token request from C to the AS, the value of the "to_rs" parameter is a CBOR byte string, whose value is the binary representation of a CBOR map C_MAP composed of two fields:<a href="#section-3.3.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.3-3.1">
              <p id="section-3.3.3-3.1.1">A field with the CBOR integer 40 as map key and with value the nonce N1 generated by C, encoded a CBOR byte string (see <span><a href="https://rfc-editor.org/rfc/rfc9203#section-4.1" class="relref">Section 4.1</a> of [<a href="#RFC9203" class="cite xref">RFC9203</a>]</span>).<a href="#section-3.3.3-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.3.3-3.2">
              <p id="section-3.3.3-3.2.1">A field with the CBOR integer 43 as map key and with value the Recipient ID ID1 generated by C, encoded as a CBOR byte string (see <span><a href="https://rfc-editor.org/rfc/rfc9203#section-4.1" class="relref">Section 4.1</a> of [<a href="#RFC9203" class="cite xref">RFC9203</a>]</span>).<a href="#section-3.3.3-3.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.3.3-4">When building the POST request for uploading the access token to the authz-info endpoint at the RS, the AS sets the Content-Format of the request to "application/ace+cbor" and composes the request payload as specified in <span><a href="https://rfc-editor.org/rfc/rfc9203#section-4.1" class="relref">Section 4.1</a> of [<a href="#RFC9203" class="cite xref">RFC9203</a>]</span>. In particular, the CBOR map specified as payload includes:<a href="#section-3.3.3-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.3-5.1">
              <p id="section-3.3.3-5.1.1">The "access_token" field, with value the access token to upload encoded as a CBOR byte string and with the CBOR integer 1 as map key.<a href="#section-3.3.3-5.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.3.3-5.2">
              <p id="section-3.3.3-5.2.1">The "nonce1" field, with value the same CBOR byte string specified by the field of C_MAP that has the CBOR integer 40 as map key.<a href="#section-3.3.3-5.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.3.3-5.3">
              <p id="section-3.3.3-5.3.1">The "ace_client_recipientid" field, with value the same CBOR byte string specified by the field of C_MAP that has the CBOR integer 43 as map key.<a href="#section-3.3.3-5.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.3.3-6">If the upload of the access token to the RS from the AS is successful, the RS replies to the AS with a 2.01 (Created) response, which has Content-Format "application/ace+cbor" and whose payload is a CBOR map RS_MAP that includes:<a href="#section-3.3.3-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.3-7.1">
              <p id="section-3.3.3-7.1.1">The "nonce2" field, with value the nonce N2 generated by the RS, encoded as a CBOR byte string (see <span><a href="https://rfc-editor.org/rfc/rfc9203#section-4.2" class="relref">Section 4.2</a> of [<a href="#RFC9203" class="cite xref">RFC9203</a>]</span>).<a href="#section-3.3.3-7.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.3.3-7.2">
              <p id="section-3.3.3-7.2.1">The "ace_server_recipientid" field, with value the Recipient ID ID2 generated by the RS, encoded as a CBOR byte string (see <span><a href="https://rfc-editor.org/rfc/rfc9203#section-4.2" class="relref">Section 4.2</a> of [<a href="#RFC9203" class="cite xref">RFC9203</a>]</span>).<a href="#section-3.3.3-7.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.3.3-8">Within the access token response from the AS to C, the value of the "from_rs" parameter is a CBOR byte string, whose value is the binary representation of a CBOR map composed of two elements:<a href="#section-3.3.3-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.3-9.1">
              <p id="section-3.3.3-9.1.1">A field with the CBOR integer 42 as map key and with value the same CBOR byte string specified by the "nonce2" field of RS_MAP.<a href="#section-3.3.3-9.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.3.3-9.2">
              <p id="section-3.3.3-9.2.1">A field with the CBOR integer 44 as map key and with value the same CBOR byte string specified by the "ace_server_recipientid" field of RS_MAP.<a href="#section-3.3.3-9.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.3.3-10">When C receives from the AS the access token response specifying the "token_upload" parameter with value 0, C retrieves the nonce N2 and the Recipient ID ID2 from the "from_rs" parameter, just like when retrieving those from a 2.01 (Created) response received from the RS when using the original workflow.<a href="#section-3.3.3-10" class="pilcrow">¶</a></p>
<p id="section-3.3.3-11"><a href="#fig-example-AS-to-C-token-upload-oscore-profile" class="auto internal xref">Figure 7</a> shows an example where the OSCORE profile is used, with first an access token request from C to the AS and then an access token response from the AS to C, following the issue of an access token bound to a symmetric PoP key.<a href="#section-3.3.3-11" class="pilcrow">¶</a></p>
<p id="section-3.3.3-12">The access token request specifies the "token_upload" parameter with value 0. That is, C indicates that it requires neither the access token nor the corresponding token hash from the AS, in case the AS successfully uploads the access token to the RS. Also, the access token request includes the "to_rs" parameter, specifying the values of N1 = 0x018a278f7faab55a and ID1 = 0x1645 intended to the RS.<a href="#section-3.3.3-12" class="pilcrow">¶</a></p>
<p id="section-3.3.3-13">The access token response specifies the "token_upload" parameter with value 0, which indicates that the AS has successfully uploaded the access token to the RS on behalf of C.<a href="#section-3.3.3-13" class="pilcrow">¶</a></p>
<p id="section-3.3.3-14">Consistent with the value of the "token_upload" parameter in the access token request, the access token response includes neither the access token nor its corresponding token hash. The access token response also includes the "cnf" parameter specifying the symmetric PoP key bound to the access token, as an OSCORE_Input_Material object (see <span><a href="https://rfc-editor.org/rfc/rfc9203#section-3.2.1" class="relref">Section 3.2.1</a> of [<a href="#RFC9203" class="cite xref">RFC9203</a>]</span>). Also, the access token response includes the "from_rs" parameter, specifying the values of N2 = 0x25a8991cd700ac01 and ID2 = 0x0000 received from the RS and intended to C.<a href="#section-3.3.3-14" class="pilcrow">¶</a></p>
<span id="name-example-of-access-token-request"></span><div id="fig-example-AS-to-C-token-upload-oscore-profile">
<figure id="figure-7">
            <div class="alignLeft art-text artwork" id="section-3.3.3-15.1">
<pre>
   Access token request

   Header: POST (Code=0.02)
   Uri-Host: "as.example.com"
   Uri-Path: "token"
   Content-Format: 19 (application/ace+cbor)
   Payload:
   {
     / audience /  5 : "tempSensor4711",
     / scope /     9 : "read",
     e'token_upload' : 0,
            e'to_rs' : h'a2182848018a278f7faab55a182b421645'
   }


   Access token response

   Header: Created (Code=2.01)
   Content-Format: 19 (application/ace+cbor)
   Max-Age: 3560
   Payload:
   {
        e'token_upload' : 0,
             e'from_rs' : h'a2182a4825a8991cd700ac01182c420000',
     / ace_profile / 38 : 2 / coap_oscore /,
       / expires_in / 2 : 3600,
       / cnf /        8 : {
         / osc / 4 : {
           / id / 0 : h'01',
           / ms / 2 : h'f9af838368e353e78888e1426bd94e6f'
         }
       }
   }
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-example-of-access-token-request" class="selfRef">Example of Access Token Request-Response Exchange where the OSCORE Profile is Used. Following a successful uploading of the access token from the AS to the RS, the access token response includes the "token_upload" parameter but not the access token, which is bound to a symmetric key and was uploaded to the RS by the AS. C and the RS exchange N1, ID1, N2, and ID2 via the AS by means of the parameters "to_rs" and "from_rs".</a>
            </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="sec-rs_cnf2-audience2">
<section id="section-3.4">
        <h3 id="name-rs_cnf2-and-audience2">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-rs_cnf2-and-audience2" class="section-name selfRef">rs_cnf2 and audience2</a>
        </h3>
<p id="section-3.4-1">This section defines the additional parameters "rs_cnf2" and "audience2". The two parameters can be used in an access token response sent by the AS (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.2" class="relref">Section 5.8.2</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>), in reply to an access token request sent to the token endpoint by C.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-2.1">
            <p id="section-3.4-2.1.1">The "rs_cnf2" parameter is <span class="bcp14">OPTIONAL</span> in an access token response, if the token type is "pop", asymmetric keys are used, and the access token is issued for an audience that includes multiple RSs (i.e., a group-audience, see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-6.9" class="relref">Section 6.9</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>). Otherwise, the "rs_cnf2" parameter <span class="bcp14">MUST NOT</span> be present.<a href="#section-3.4-2.1.1" class="pilcrow">¶</a></p>
<p id="section-3.4-2.1.2">
This parameter specifies information about the public keys used by the RSs of the group-audience for authenticating themselves to C. It is used in case the binding between the public keys and the corresponding RS identities are not established through other means. If this parameter is absent, either the RSs in the group-audience do not use a public key, or the AS knows that the RSs can authenticate themselves to C without additional information.<a href="#section-3.4-2.1.2" class="pilcrow">¶</a></p>
<p id="section-3.4-2.1.3">
If present, this parameter <span class="bcp14">MUST</span> encode a non-empty CBOR array of N elements, where N is the number of RSs in the group-audience for which the access token is issued. Each element of the CBOR array specifies the public key of an RS in the group-audience, and <span class="bcp14">MUST</span> follow the syntax and semantics of the "cnf" claim either from <span><a href="https://rfc-editor.org/rfc/rfc8747#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC8747" class="cite xref">RFC8747</a>]</span> for CBOR-based interactions, or from <span><a href="https://rfc-editor.org/rfc/rfc7800#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC7800" class="cite xref">RFC7800</a>]</span> for JSON-based interactions. It is not required that all the elements of the CBOR array rely on the same confirmation method.<a href="#section-3.4-2.1.3" class="pilcrow">¶</a></p>
<p id="section-3.4-2.1.4">
Any of the public keys may be provided together with information such as the public key algorithm and use (e.g., specified by means of the parameters "alg" and "key_ops" in a COSE_Key structure). If such information is specified, a client <span class="bcp14">MUST NOT</span> use a public key that is incompatible with the profile of ACE used or with the PoP algorithm according to that information. An RS <span class="bcp14">MUST</span> reject a proof of possession that relies on such a key and <span class="bcp14">MUST</span> reply with a response code equivalent to the CoAP code 4.00 (Bad Request).<a href="#section-3.4-2.1.4" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-2.2">
            <p id="section-3.4-2.2.1">The "audience2" parameter is <span class="bcp14">OPTIONAL</span> in an access token response, and it specifies the identifiers of the RSs in the group-audience for which the access token is issued.<a href="#section-3.4-2.2.1" class="pilcrow">¶</a></p>
<p id="section-3.4-2.2.2">
If present, this parameter <span class="bcp14">MUST</span> encode a non-empty CBOR array of N elements, where N is the number of RSs in the group-audience for which the access token is issued. Each element of the CBOR array in the "audience2" parameter <span class="bcp14">MUST</span> be a CBOR text string, with value the identifier of an RS in the group-audience.<a href="#section-3.4-2.2.2" class="pilcrow">¶</a></p>
<p id="section-3.4-2.2.3">
The element of the CBOR array referring to an RS in the group-audience <span class="bcp14">SHOULD</span> have the same value that would be used to identify that RS through the "audience" parameter of an access token request to the AS (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.1" class="relref">Section 5.8.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>) and of an access token response from the AS (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.2" class="relref">Section 5.8.2</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>), when requesting and issuing an access token for that individual RS.<a href="#section-3.4-2.2.3" class="pilcrow">¶</a></p>
<p id="section-3.4-2.2.4">
The "audience2" parameter is <span class="bcp14">REQUIRED</span> if the "rs_cnf2" parameter is present. In such a case, the i-th element of the CBOR array in the "audience2" parameter <span class="bcp14">MUST</span> be the identifier of the RS whose public key is specified by the i-th element of the CBOR array in the "rs_cnf2" parameter.<a href="#section-3.4-2.2.4" class="pilcrow">¶</a></p>
</li>
        </ul>
<div id="example-1">
<section id="section-3.4.1">
          <h4 id="name-example-2">
<a href="#section-3.4.1" class="section-number selfRef">3.4.1. </a><a href="#name-example-2" class="section-name selfRef">Example</a>
          </h4>
<p id="section-3.4.1-1"><a href="#fig-example-AS-to-C-rs_cnf2" class="auto internal xref">Figure 8</a> shows an example of access token response from the AS to C, following the issue of an access token for a group-audience composed of two RSs, namely "rs1" and "rs2", and bound to C's public key as an asymmetric PoP key. The access token response includes the access token as well as the parameters "audience2" and "rs_cnf2". These parameters specify the public key of the two RSs as the intended recipients of the access token and the identifiers of those two RSs, respectively.<a href="#section-3.4.1-1" class="pilcrow">¶</a></p>
<span id="name-example-of-access-token-res"></span><div id="fig-example-AS-to-C-rs_cnf2">
<figure id="figure-8">
            <div class="alignLeft art-text artwork" id="section-3.4.1-2.1">
<pre>
   Access token response

   Header: Created (Code=2.01)
   Content-Format: 19 (application/ace+cbor)
   Max-Age: 3600
   Payload:
   {
     / access_token / 1 : b64'SlAV32hk...12',
       / (full CWT elided for brevity;
          CWT contains the client's RPK in the "cnf" claim) /
     / expires_in /   2 : 3600,
           e'audience2' : ["rs1", "rs2"],
             e'rs_cnf2' : [
               {
                 / COSE_Key / 1 : {
                   / kty /  1 : 2 / EC2 /,
                   / crv / -1 : 1 / P-256 /,
                   / x /   -2 : h'bbc34960526ea4d32e940cad2a234148
                                  ddc21791a12afbcbac93622046dd44f0',
                   / y /   -3 : h'4519e257236b2a0ce2023f0931f1f386
                                  ca7afda64fcde0108c224c51eabf6072'
                 }
               },
               {
                 / COSE_Key / 1 : {
                   / kty /  1 : 2 / EC2 /,
                   / crv / -1 : 1 / P-256 /,
                   / x /   -2 : h'ac75e9ece3e50bfc8ed6039988952240
                                  5c47bf16df96660a41298cb4307f7eb6',
                   / y /   -3 : h'6e5de611388a4b8a8211334ac7d37ecb
                                  52a387d257e6db3c2a93df21ff3affc8'
                 }
               }
             ]
   }
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-example-of-access-token-res" class="selfRef">Example of access token response with an access token bound to an asymmetric key, using the parameters "audience2" and "rs_cnf2".</a>
            </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="sec-anchor_cnf">
<section id="section-3.5">
        <h3 id="name-anchor_cnf">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-anchor_cnf" class="section-name selfRef">anchor_cnf</a>
        </h3>
<p id="section-3.5-1">This section defines the additional "anchor_cnf" parameter. The parameter can be used in an access token response sent by the AS (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.2" class="relref">Section 5.8.2</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>), in reply to an access token request sent to the token endpoint by C.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.5-2">The "anchor_cnf" parameter is <span class="bcp14">OPTIONAL</span> in an access token response, if the token type is "pop" and asymmetric keys are used. Otherwise, the "anchor_cnf" parameter <span class="bcp14">MUST NOT</span> be present.<a href="#section-3.5-2" class="pilcrow">¶</a></p>
<p id="section-3.5-3">This parameter specifies information about the public keys of trust anchors, which C can use to validate the public key of the RS/RSs included in the audience for which the access token is issued. This parameter can be used when the access token is issued for an audience including one RS or multiple RSs.<a href="#section-3.5-3" class="pilcrow">¶</a></p>
<p id="section-3.5-4">If this parameter is absent, either the RS/RSs in the audience do not use a public key, or the AS knows that C can validate the public key of such RS/RSs without additional information (e.g., C has already obtained the required public keys of the involved trust anchors from the AS or through other means).<a href="#section-3.5-4" class="pilcrow">¶</a></p>
<p id="section-3.5-5">If present, this parameter <span class="bcp14">MUST</span> encode a non-empty CBOR array that <span class="bcp14">MUST</span> be treated as a set, i.e., the order of its elements has no meaning. Each element of the CBOR array specifies the public key of one trust anchor, which can be used to validate the public key of at least one RS included in the audience for which the access token is issued. Each element of the CBOR array <span class="bcp14">MUST</span> follow the syntax and semantics of the "cnf" claim either from <span><a href="https://rfc-editor.org/rfc/rfc8747#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC8747" class="cite xref">RFC8747</a>]</span> for CBOR-based interactions, or from <span><a href="https://rfc-editor.org/rfc/rfc7800#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC7800" class="cite xref">RFC7800</a>]</span> for JSON-based interactions. It is not required that all the elements of the CBOR array rely on the same confirmation method.<a href="#section-3.5-5" class="pilcrow">¶</a></p>
<p id="section-3.5-6">Any of the public keys conveyed in the "anchor_cnf" parameter may be provided together with information such as the public key algorithm and use (e.g., specified by means of the parameters "alg" and "key_ops" in a COSE_Key structure). If such information is specified, a client <span class="bcp14">MUST NOT</span> use a public key that is incompatible with the profile of ACE used or with the public keys to validate and the way to validate those.<a href="#section-3.5-6" class="pilcrow">¶</a></p>
<p id="section-3.5-7">The presence of this parameter does not require that the access token response also includes the "rs_cnf" parameter defined in <span>[<a href="#RFC9201" class="cite xref">RFC9201</a>]</span> or the "rs_cnf2" parameter defined in <a href="#sec-rs_cnf2-audience2" class="auto internal xref">Section 3.4</a> of the present document. That is, C may be able to obtain the public keys of the RS/RSs for which the access token is issued through other means.<a href="#section-3.5-7" class="pilcrow">¶</a></p>
<p id="section-3.5-8">When the access token response includes both the "anchor_cnf" parameter and the "audience2" parameter defined in <a href="#sec-rs_cnf2-audience2" class="auto internal xref">Section 3.4</a>, then C <span class="bcp14">MUST</span> make sure that a public key PK_RS is associated with an RS identified by an element of "audience2", before using any of the public keys specified in "anchor_cnf" to validate PK_RS.<a href="#section-3.5-8" class="pilcrow">¶</a></p>
<p id="section-3.5-9">When the access token response includes the "anchor_cnf" parameter but not the "audience2" parameter, then C can use any of the public keys specified in "anchor_cnf" to validate the public key PK_RS of any RS in the targeted audience. This allows C to use the access token with an RS that is deployed later on as part of the same audience, which is particularly useful in the case of a group-audience.<a href="#section-3.5-9" class="pilcrow">¶</a></p>
<div id="example-2">
<section id="section-3.5.1">
          <h4 id="name-example-3">
<a href="#section-3.5.1" class="section-number selfRef">3.5.1. </a><a href="#name-example-3" class="section-name selfRef">Example</a>
          </h4>
<p id="section-3.5.1-1"><a href="#fig-example-AS-to-C-anchor_cnf" class="auto internal xref">Figure 9</a> shows an example of access token response from the AS to C, following the issue of an access token for a group-audience and bound to C's public key as an asymmetric PoP key.<a href="#section-3.5.1-1" class="pilcrow">¶</a></p>
<p id="section-3.5.1-2">The identifier of the group-audience was specified by the "audience" parameter of the access token request to the AS, is specified by the "aud" claim of the issued access token, and is not repeated in the access token response from the AS.<a href="#section-3.5.1-2" class="pilcrow">¶</a></p>
<p id="section-3.5.1-3">The access token response includes the "anchor_cnf" parameter. This specifies the public key of a trust anchor that C can use to validate the public keys of any RS with which the access token is going to be used. By means of the CWT confirmation method "x5chain" defined in <span>[<a href="#I-D.ietf-ace-edhoc-oscore-profile" class="cite xref">I-D.ietf-ace-edhoc-oscore-profile</a>]</span>, the public key of the trust anchor is here conveyed within an X.509 certificate <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span> used as the public authentication credential for that trust anchor.<a href="#section-3.5.1-3" class="pilcrow">¶</a></p>
<span id="name-example-of-access-token-resp"></span><div id="fig-example-AS-to-C-anchor_cnf">
<figure id="figure-9">
            <div class="alignLeft art-text artwork" id="section-3.5.1-4.1">
<pre>
   Access token response

   Header: Created (Code=2.01)
   Content-Format: 19 (application/ace+cbor)
   Max-Age: 3600
   Payload:
   {
     / access_token / 1 : b64'SlAV32hk...12',
       / (full CWT elided for brevity;
          CWT contains the client's RPK in the "cnf" claim) /
     / expires_in /   2 : 3600,
          e'anchor_cnf' : [
            {
              e'x5chain' : h'308201363081dea003020102020301f50d30
                             0a06082a8648ce3d04030230163114301206
                             035504030c0b524643207465737420434130
                             1e170d3230303130313030303030305a170d
                             3231303230323030303030305a3022312030
                             1e06035504030c1730312d32332d34352d46
                             462d46452d36372d38392d41423059301306
                             072a8648ce3d020106082a8648ce3d030107
                             03420004b1216ab96e5b3b3340f5bdf02e69
                             3f16213a04525ed44450b1019c2dfd3838ab
                             ac4e14d86c0983ed5e9eef2448c6861cc406
                             547177e6026030d051f7792ac206a30f300d
                             300b0603551d0f040403020780300a06082a
                             8648ce3d04030203470030440220445d798c
                             90e7f500dc747a654cec6cfa6f037276e14e
                             52ed07fc16294c84660d02205a33985dfbd4
                             bfdd6d4acf3804c3d46ebf3b7fa62640674f
                             c0354fa056dbaea6'
            }
          ]
   }
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-example-of-access-token-resp" class="selfRef">Example of Access Token Response with an access token bound to an asymmetric key, using the "anchor_cnf" parameter.</a>
            </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="sec-token_series_id">
<section id="section-3.6">
        <h3 id="name-token_series_id">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-token_series_id" class="section-name selfRef">token_series_id</a>
        </h3>
<p id="section-3.6-1">This section defines the additional "token_series_id" parameter. The parameter can be used in an access token request sent by C to the token endpoint at the AS (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.1" class="relref">Section 5.8.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>), as well as in the access token response sent as a reply by the AS (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.2" class="relref">Section 5.8.2</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>).<a href="#section-3.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.6-2.1">
            <p id="section-3.6-2.1.1">The "token_series_id" parameter is <span class="bcp14">OPTIONAL</span> in an access token request. The presence of this parameter indicates that C wishes to obtain a new access token for dynamically updating its access rights. That is, the new access token is intended to be the next one in an active token series and to supersede the latest access token in that token series. This parameter <span class="bcp14">MUST NOT</span> be present if the requested access token is the first one of a new token series.<a href="#section-3.6-2.1.1" class="pilcrow">¶</a></p>
<p id="section-3.6-2.1.2">
If present, this parameter specifies the identifier of the token series that the new access token is intended to extend. The identifier does not change throughout the lifetime of the token series and was provided to C in the access token response that the AS sent when issuing the first access token in that token series. When the access token request is encoded in CBOR, the value of this parameter is encoded as a CBOR byte string.<a href="#section-3.6-2.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.6-2.2">
            <p id="section-3.6-2.2.1">The "token_series_id" parameter is <span class="bcp14">OPTIONAL</span> in an access token response. This parameter <span class="bcp14">MUST NOT</span> be present if the issued access token is not the first one of the token series it belongs to.<a href="#section-3.6-2.2.1" class="pilcrow">¶</a></p>
<p id="section-3.6-2.2.2">
If present, this parameter specifies the identifier of the token series to which the issued access token belongs. When the access token response is encoded in CBOR, the value of this parameter is encoded as a CBOR byte string.<a href="#section-3.6-2.2.2" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.6-3">If the AS relies on the "token_series_id" parameter to exchange the identifier of token series with clients, then the following applies.<a href="#section-3.6-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.6-4.1">
            <p id="section-3.6-4.1.1">The value assigned to the identifier of a token series <span class="bcp14">MUST</span> be associated with all the access tokens issued by the AS for that token series and <span class="bcp14">MUST</span> be selected from a pool that the AS exclusively controls.<a href="#section-3.6-4.1.1" class="pilcrow">¶</a></p>
<p id="section-3.6-4.1.2">
In particular, the triple (TS_ID, C, AUD) <span class="bcp14">MUST</span> uniquely identify a token series and its corresponding access tokens, where TS_ID is the identifier of the token series, while C and AUD are the client and the audience for which the access token is issued, respectively. The AS <span class="bcp14">MUST</span> take into account both ongoing and ended token series for selecting a new TS_ID that complies with the above requirements.<a href="#section-3.6-4.1.2" class="pilcrow">¶</a></p>
<p id="section-3.6-4.1.3">
Note that the ACE profile is not part of the triple, hence the requirement spans across all the ACE profiles that the AS and its registered clients/RSs support.<a href="#section-3.6-4.1.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.6-4.2">
            <p id="section-3.6-4.2.1">An issued access token that belongs to a token series <span class="bcp14">MUST</span> include the identifier of that token series. This allows the RS to identify the latest access token in the token series to be superseded by the issued access token.<a href="#section-3.6-4.2.1" class="pilcrow">¶</a></p>
<p id="section-3.6-4.2.2">
In particular, each of such access tokens <span class="bcp14">MUST</span> include a claim specifying the identifier of the token series to which the access token belongs. When CWTs are used as access tokens, this information <span class="bcp14">MUST</span> be transported in the "token_series_id" claim registered in <a href="#iana-token-cwt-claims" class="auto internal xref">Section 10.4</a>.<a href="#section-3.6-4.2.2" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.6-5">If a profile of ACE relies on a construct that uses different parameters/claims to transport the identifier of a token series, then the new "token_series_id" parameter and "token_series_id" claim <span class="bcp14">MUST NOT</span> be used when using that profile.<a href="#section-3.6-5" class="pilcrow">¶</a></p>
<p id="section-3.6-6">For example, a number of parameters/claims are already used to transport information that acts as de facto identifier of token series, in the PSK mode of the DTLS profile <span>[<a href="#RFC9202" class="cite xref">RFC9202</a>]</span>, in the OSCORE profile <span>[<a href="#RFC9203" class="cite xref">RFC9203</a>]</span>, and in the EDHOC and OSCORE profile <span>[<a href="#I-D.ietf-ace-edhoc-oscore-profile" class="cite xref">I-D.ietf-ace-edhoc-oscore-profile</a>]</span>.<a href="#section-3.6-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-updated_rights">
<section id="section-3.7">
        <h3 id="name-updated_rights">
<a href="#section-3.7" class="section-number selfRef">3.7. </a><a href="#name-updated_rights" class="section-name selfRef">updated_rights</a>
        </h3>
<p id="section-3.7-1">This section defines the additional "updated_rights" parameter. The parameter can be used in a POST request sent by the AS to the authz-info endpoint at the RS (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.10.1" class="relref">Section 5.10.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>), when the AS uploads an access token to the RS per the SDC workflow defined in <a href="#sec-workflow" class="auto internal xref">Section 2</a> of the present document. The "updated_rights" parameter <span class="bcp14">MUST NOT</span> be included in the POST request to the authz-info endpoint sent by C per the original workflow defined in <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#section-3.7-1" class="pilcrow">¶</a></p>
<p id="section-3.7-2">The "updated_rights" parameter is <span class="bcp14">REQUIRED</span> in the POST request sent by the AS to the authz-info endpoint at the RS, if the uploaded access token is not the first one of a new token series, i.e., if the AS has issued the access token for dynamically updating the access rights of C. Otherwise, the "updated_rights" parameter <span class="bcp14">MUST NOT</span> be present.<a href="#section-3.7-2" class="pilcrow">¶</a></p>
<p id="section-3.7-3">When including the "updated_rights" parameter, the POST request <span class="bcp14">MUST</span> have Content-Format "application/ace+cbor" and its payload <span class="bcp14">MUST</span> be formatted as a CBOR map. In particular, the CBOR map <span class="bcp14">MUST</span> include the "updated_rights" parameter encoding the CBOR simple value <code>true</code> (0xf5), together with the "access_token" parameter specifying the access token. The CBOR map <span class="bcp14">MAY</span> include additional parameters, according to the specific profile of ACE used.<a href="#section-3.7-3" class="pilcrow">¶</a></p>
<p id="section-3.7-4">Note that this request deviates from the POST request defined in <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>, although such a deviation can already occur in some profiles of ACE (e.g., see <span><a href="https://rfc-editor.org/rfc/rfc9203#section-4.1" class="relref">Section 4.1</a> of [<a href="#RFC9203" class="cite xref">RFC9203</a>]</span>) or in application profiles of <span>[<a href="#RFC9594" class="cite xref">RFC9594</a>]</span>.<a href="#section-3.7-4" class="pilcrow">¶</a></p>
<p id="section-3.7-5">When the RS receives a protected POST request to the authz-info endpoint from the AS and the request does not convey the "updated_rights" parameter, the RS is ensured that the access token conveyed in the request is the first one of a new token series.<a href="#section-3.7-5" class="pilcrow">¶</a></p>
<p id="section-3.7-6">When the RS receives a protected POST request to the authz-info endpoint from the AS and the request conveys the "updated_rights" parameter encoding the CBOR simple value <code>true</code> (0xf5), the RS is ensured that the access token conveyed in the request is not the first one of a new token series.<a href="#section-3.7-6" class="pilcrow">¶</a></p>
<p id="section-3.7-7">Taking advantage of such explicit indication requires the RS to support the Content-Format "application/ace+cbor" and the "updated_rights" parameter.<a href="#section-3.7-7" class="pilcrow">¶</a></p>
<p id="section-3.7-8">If the RS does not support the Content-Format "application/ace+cbor", the RS rejects the POST request from the AS and replies with an error response that has a response code equivalent to the CoAP code 4.15 (Unsupported Content-Format). Note that, irrespective of the profile of ACE used, the RS supports the Content-Format "application/ace+cbor" if it implements token introspection as defined in <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.9" class="relref">Section 5.9</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#section-3.7-8" class="pilcrow">¶</a></p>
<p id="section-3.7-9">If the RS supports the Content-Format "application/ace+cbor" but does not support the "updated_rights" parameter, the RS rejects the POST request from the AS and replies with an error response that has a response code equivalent to the CoAP code 4.00 (Bad Request).<a href="#section-3.7-9" class="pilcrow">¶</a></p>
<p id="section-3.7-10">In case a POST request to the authz-info endpoint includes the "updated_rights" parameter, the RS supports the parameter, and any of the following conditions applies, the RS <span class="bcp14">MUST</span> reject the request and <span class="bcp14">MUST</span> reply with an error response that has a response code equivalent to the CoAP code 4.00 (Bad Request):<a href="#section-3.7-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.7-11.1">
            <p id="section-3.7-11.1.1">The request is not protected.<a href="#section-3.7-11.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.7-11.2">
            <p id="section-3.7-11.2.1">The AS is not successfully verified as the originator of the request.<a href="#section-3.7-11.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.7-11.3">
            <p id="section-3.7-11.3.1">The "updated_rights" parameter does not encode the CBOR simple value <code>true</code> (0xf5).<a href="#section-3.7-11.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.7-12">If the AS receives an error response from the RS, the AS replies to C with an access token response, which includes the "access_token" parameter specifying the issued access token and includes the "token_upload" parameter encoding the value 1 (see <a href="#sec-token_upload" class="auto internal xref">Section 3.1</a>).<a href="#section-3.7-12" class="pilcrow">¶</a></p>
<p id="section-3.7-13">The processing of the POST request sent to the authz-info endpoint by the AS is further described in <a href="#sec-as-token-upload" class="auto internal xref">Section 2.1</a>.<a href="#section-3.7-13" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-updated-ace-profile-parameter">
<section id="section-4">
      <h2 id="name-updated-ace_profile-paramet">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-updated-ace_profile-paramet" class="section-name selfRef">Updated "ace_profile" Parameter</a>
      </h2>
<p id="section-4-1">This section extends the semantics of the "ace_profile" parameter defined in <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> for the OAuth 2.0 token endpoint at the AS.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">In addition to what is specified in Sections <a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.1" class="relref">5.8.1</a>, <a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.2" class="relref">5.8.2</a>, and <a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.4.3" class="relref">5.8.4.3</a> of <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>, the following applies.<a href="#section-4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-3.1">
          <p id="section-4-3.1.1">When sending an access token request to the token endpoint at the AS (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.1" class="relref">Section 5.8.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>), C <span class="bcp14">MAY</span> include the "ace_profile" parameter, specifying the identifier of the profile that C wishes to use towards the RS.<a href="#section-4-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-3.2">
          <p id="section-4-3.2.1">If the AS receives an access token request that includes the "ace_profile" parameter specifying the identifier of a profile, then the AS proceeds as follows.<a href="#section-4-3.2.1" class="pilcrow">¶</a></p>
<p id="section-4-3.2.2">
In case the AS does not issue access tokens per the profile specified in the access token request, or C and the RS do not share that profile, then the AS <span class="bcp14">MUST</span> reject the request and <span class="bcp14">MUST</span> reply with an error response (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.3" class="relref">Section 5.8.3</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>). The error response <span class="bcp14">MUST</span> have a response code equivalent to the CoAP code 4.00 (Bad Request) and <span class="bcp14">MUST</span> include the error code "incompatible_ace_profiles".<a href="#section-4-3.2.2" class="pilcrow">¶</a></p>
<p id="section-4-3.2.3">
In case the AS issues an access token to C, the access token <span class="bcp14">MUST</span> be per the profile whose identifier was specified by the "ace_profile" parameter in the access token request.<a href="#section-4-3.2.3" class="pilcrow">¶</a></p>
<p id="section-4-3.2.4">
In case the AS replies to C with an access token response (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.2" class="relref">Section 5.8.2</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>), then the response <span class="bcp14">MAY</span> include the "ace_profile" parameter. If it is included in the access token response, the "ace_profile" parameter <span class="bcp14">MUST</span> encode the same profile identifier that was specified by the "ace_profile" parameter of the corresponding access token request.<a href="#section-4-3.2.4" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="sec-coord-exchanged-cred">
<section id="section-5">
      <h2 id="name-coordinating-on-the-exchang">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-coordinating-on-the-exchang" class="section-name selfRef">Coordinating on the Exchange of Public Authentication Credentials</a>
      </h2>
<p id="section-5-1">In some profiles of ACE, it is possible for C and the RS to use public authentication credentials. Depending on the specific profile, the access token request and response exchanged between C and the AS can specify those authentication credentials as transported by value or instead identified by reference. For instance, this is the case in the EDHOC and OSCORE profile <span>[<a href="#I-D.ietf-ace-edhoc-oscore-profile" class="cite xref">I-D.ietf-ace-edhoc-oscore-profile</a>]</span> and in the DTLS profile <span>[<a href="#RFC9202" class="cite xref">RFC9202</a>]</span> as extended in <span>[<a href="#I-D.ietf-ace-authcred-dtls-profile" class="cite xref">I-D.ietf-ace-authcred-dtls-profile</a>]</span>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">At some point, the AS (C) might become unable to use a credential identifier as a reference for accessing the authentication credential of C (of the RS) obtained earlier, e.g., due to having deleted the credential from its local storage. This can prevent the AS (C) from successfully processing an incoming access token request (response) that specifies the authentication credential of C (of the RS) as identified by reference. Ultimately, this can prevent the AS from issuing an access token and C from securely accessing protected resources at the RS.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">Conversely, unbeknown to the AS, C might already be storing the authentication credential of the RS when sending the access token request. In such a situation, the AS would specify the authentication credential of the RS by value in the access token response. However, it would be sufficient for C that the response specified the credential of the RS as identified by reference, or even that the response omitted the credential altogether.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">In order to allow C and the AS to coordinate on the exchange of the authentication credentials of C and the RS, the rest of this section defines:<a href="#section-5-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-5.1">
          <p id="section-5-5.1.1">How the AS can instruct C to specify its public authentication credential by value in the "req_cnf" parameter of an access token request (see <a href="#sec-cred-c-value" class="auto internal xref">Section 5.1</a>).<a href="#section-5-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-5.2">
          <p id="section-5-5.2.1">How C can instruct the AS to specify the public authentication credential(s) of the RS(s) by value or by reference in the "rs_cnf" or "rs_cnf2" parameter of an access token response (see <a href="#sec-cred-rs-value" class="auto internal xref">Section 5.2</a>), or instead to omit the credential(s) from the access token response.<a href="#section-5-5.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="sec-cred-c-value">
<section id="section-5.1">
        <h3 id="name-instructing-c-on-how-to-pro">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-instructing-c-on-how-to-pro" class="section-name selfRef">Instructing C on How to Provide its Authentication Credential</a>
        </h3>
<p id="section-5.1-1">When the AS receives an access token request and this includes the "req_cnf" parameter identifying the public authentication credential of C by reference, it might happen that the AS is not able to access the credential by using the specified reference.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">In such a case, the AS <span class="bcp14">MUST</span> reject the request and <span class="bcp14">MUST</span> reply with an error response (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.3" class="relref">Section 5.8.3</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>). The error response <span class="bcp14">MUST</span> have a response code equivalent to the CoAP code 5.00 (Internal Server Error) and <span class="bcp14">MUST</span> include the error code "unknown_credential_referenced". The error code and its CBOR abbreviation are registered in <a href="#iana-oauth-extensions-errors" class="auto internal xref">Section 10.5</a> and <a href="#iana-oauth-error-code-cbor-mappings" class="auto internal xref">Section 10.6</a>, respectively.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">After receiving such an error response, C can send a new access token request, where the "req_cnf" parameter specifies the authentication credential of C by value.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-cred-rs-value">
<section id="section-5.2">
        <h3 id="name-instructing-the-as-on-how-t">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-instructing-the-as-on-how-t" class="section-name selfRef">Instructing the AS on How to Provide the RS's Authentication Credential</a>
        </h3>
<p id="section-5.2-1">When C receives an access token response and this includes the "req_cnf" or "req_cnf2" parameter identifying the authentication credential(s) of the RS(s) by reference, it might happen that C is not able to access the authentication credential(s) by using the specified reference(s).<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">Conversely, if the response includes the "rs_cnf" or "rs_cnf2" parameter specifying the authentication credential(s) of the RS(s) by value, it might happen that C has already been storing those credential(s), unbeknown to the AS. In fact, it would have been sufficient that the "rs_cnf" or "rs_cnf2" parameter identified the credential(s) by reference, or that neither parameter was included in the response.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">The following extends the semantics of the "rs_cnf" parameter defined in <span><a href="https://rfc-editor.org/rfc/rfc9201#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC9201" class="cite xref">RFC9201</a>]</span>, so that C can include the "rs_cnf" parameter in an access token request. When doing so, C instructs the AS about whether and how the access token response should specify the authentication credential(s) of the RS(s) belonging to the targeted audience.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">Per its extended semantics, the "rs_cnf" parameter is also <span class="bcp14">OPTIONAL</span> to include in an access token request for requesting the first access token in a token series, if the token type is "pop" and asymmetric keys are used. Otherwise, the parameter <span class="bcp14">MUST NOT</span> be included in an access token request.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2-5">When C includes the "rs_cnf" parameter in an access token request, the parameter <span class="bcp14">MUST</span> have one of the following encodings.<a href="#section-5.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-6.1">
            <p id="section-5.2-6.1.1">If the parameter specifies the CBOR simple value <code>true</code> (0xf5), then it instructs the AS to include in the access token response the "rs_cnf" or "rs_cnf2" parameter, specifying the authentication credential(s) of the RS(s) by value.<a href="#section-5.2-6.1.1" class="pilcrow">¶</a></p>
<p id="section-5.2-6.1.2">
In the access token response, each pertaining authentication credential <span class="bcp14">MUST</span> be specified by value.<a href="#section-5.2-6.1.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.2-6.2">
            <p id="section-5.2-6.2.1">If the parameter specifies the CBOR simple value <code>false</code> (0xf4), then it instructs the AS to include in the access token response the "rs_cnf" or "rs_cnf2" parameter, specifying the authentication credential(s) of the RS(s) by reference.<a href="#section-5.2-6.2.1" class="pilcrow">¶</a></p>
<p id="section-5.2-6.2.2">
In the access token response, each pertaining authentication credential <span class="bcp14">MUST</span> be specified by reference, or alternatively by value only in case that was not possible for the AS to attain.<a href="#section-5.2-6.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.2-6.3">
            <p id="section-5.2-6.3.1">If the parameter specifies the CBOR simple value <code>null</code> (0xf6), then it instructs the AS to omit the "rs_cnf" and "rs_cnf2" parameters from the access token response.<a href="#section-5.2-6.3.1" class="pilcrow">¶</a></p>
<p id="section-5.2-6.3.2">
In the access token response, the "rs_cnf" and "rs_cnf2" parameters <span class="bcp14">MUST NOT</span> be included.<a href="#section-5.2-6.3.2" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.2-7">If the AS is not able to comply in the first two cases above, then the AS <span class="bcp14">MUST</span> reject the request and <span class="bcp14">MUST</span> reply with an error response. The error response <span class="bcp14">MUST</span> have a response code equivalent to the CoAP code 5.00 (Internal Server Error).<a href="#section-5.2-7" class="pilcrow">¶</a></p>
<p id="section-5.2-8">Irrespective of what "rs_cnf" specifies in the access token request, C <span class="bcp14">MUST</span> rely on the authentication credential(s) specified by the parameter "rs_cnf" or "rs_cnf2" in the access token response, as those that are used by the RS(s) to authenticate.<a href="#section-5.2-8" class="pilcrow">¶</a></p>
<p id="section-5.2-9">If C does not currently store the authentication credential(s) of the RS(s), then C <span class="bcp14">MUST NOT</span> include the "rs_cnf" parameter specifying the CBOR simple value <code>null</code> (0xf6) in an access token request.<a href="#section-5.2-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-error-failed-pop">
<section id="section-6">
      <h2 id="name-failed-verification-of-proo">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-failed-verification-of-proo" class="section-name selfRef">Failed Verification of Proof of Possession at the AS</a>
      </h2>
<p id="section-6-1">When sending an access token request to the AS (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.1" class="relref">Section 5.8.1</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>), a client can include the "req_cnf" parameter defined in <span><a href="https://rfc-editor.org/rfc/rfc9201#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC9201" class="cite xref">RFC9201</a>]</span> in order to provide the AS with a specific PoP key to bind to the requested access token.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">Typically, the PoP key in question is the client's public key. In such a case, as per <span><a href="https://rfc-editor.org/rfc/rfc9201#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC9201" class="cite xref">RFC9201</a>]</span>, the AS has to verify proof of possession of the client's private key, i.e., that the client is indeed in possession of the private key corresponding to the public key conveyed in the "req_cnf" parameter.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">The AS might have previously achieved proof of possession of the private key in question, e.g., from previous interactions with the client or through out-of-band means. Alternatively, a profile of ACE might define how the AS verifies a PoP evidence that the client computes and provides to the AS by means of a parameter included in the access token request (e.g., see <span>[<a href="#I-D.ietf-ace-group-oscore-profile" class="cite xref">I-D.ietf-ace-group-oscore-profile</a>]</span>).<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">Irrespective of the method used, if the AS fails to verify the proof of possession of the client's private key, then the AS <span class="bcp14">MUST</span> reject the access token request and <span class="bcp14">MUST</span> reply with an error response (see <span><a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.3" class="relref">Section 5.8.3</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>). The error response <span class="bcp14">MUST</span> have a response code equivalent to the CoAP code 4.00 (Bad Request) and <span class="bcp14">MUST</span> include the error code "failed_pop_verification". The error code and its CBOR abbreviation are registered in <a href="#iana-oauth-extensions-errors" class="auto internal xref">Section 10.5</a> and <a href="#iana-oauth-error-code-cbor-mappings" class="auto internal xref">Section 10.6</a>, respectively.<a href="#section-6-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-updated-error-responses">
<section id="section-7">
      <h2 id="name-updated-payload-format-of-e">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-updated-payload-format-of-e" class="section-name selfRef">Updated Payload Format of Error Responses</a>
      </h2>
<p id="section-7-1">This section deprecates the original payload format of error responses conveying an error code, when CBOR is used to encode message payloads in the ACE framework. That format is referred to, e.g., when defining the error responses of Sections <a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.3" class="relref">5.8.3</a> and <a href="https://rfc-editor.org/rfc/rfc9200#section-5.9.3" class="relref">5.9.3</a> of <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">Also, this section defines a new payload format that allows such error responses to convey an error code together with further error-specific information, according to the problem-details format specified in <span>[<a href="#RFC9290" class="cite xref">RFC9290</a>]</span>.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">Such error responses <span class="bcp14">MUST</span> have Content-Format set to "application/concise-problem-details+cbor". The payload of these error responses <span class="bcp14">MUST</span> be a CBOR map specifying a Concise Problem Details data item (see <span><a href="https://rfc-editor.org/rfc/rfc9290#section-2" class="relref">Section 2</a> of [<a href="#RFC9290" class="cite xref">RFC9290</a>]</span>). The CBOR map is formatted as follows:<a href="#section-7-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-4.1">
          <p id="section-7-4.1.1">It <span class="bcp14">MUST</span> include the Custom Problem Detail entry "ace-error" registered in <a href="#iana-problem-details" class="auto internal xref">Section 10.7</a> of this document.<a href="#section-7-4.1.1" class="pilcrow">¶</a></p>
<p id="section-7-4.1.2">
This entry is formatted as a CBOR map including only one field, namely "error-code". The map key for the "error-code" field is the CBOR integer with value 0. The value of the "error-code" field is a CBOR integer specifying the error code associated with the occurred error. This value is taken from the "CBOR Value" column of the "OAuth Error Code CBOR Mappings" registry <span>[<a href="#ACE.OAuth.Error.Code.CBOR.Mappings" class="cite xref">ACE.OAuth.Error.Code.CBOR.Mappings</a>]</span>.<a href="#section-7-4.1.2" class="pilcrow">¶</a></p>
<p id="section-7-4.1.3">
The "error-code" field conveys the same information that the original payload format conveys through the "error" parameter (see, e.g., Sections <a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.3" class="relref">5.8.3</a> and <a href="https://rfc-editor.org/rfc/rfc9200#section-5.9.3" class="relref">5.9.3</a> of <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>).<a href="#section-7-4.1.3" class="pilcrow">¶</a></p>
<p id="section-7-4.1.4">
The CDDL notation <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> of the "ace-error" entry is given below.<a href="#section-7-4.1.4" class="pilcrow">¶</a></p>
</li>
      </ul>
<div class="lang-cddl sourcecode" id="section-7-5">
<pre>
   ace-error = {
     &amp;(error-code: 0) =&gt; int
   }
</pre><a href="#section-7-5" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-7-6.1">
          <p id="section-7-6.1.1">It <span class="bcp14">MAY</span> include further Standard Problem Detail entries or Custom Problem Detail entries (see <span>[<a href="#RFC9290" class="cite xref">RFC9290</a>]</span>). The following Standard Problem Detail entries are of particular relevance for the ACE framework.<a href="#section-7-6.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-6.1.2.1">
              <p id="section-7-6.1.2.1.1">"detail" (map key -2): its value is a CBOR text string that specifies a human-readable diagnostic description of the occurred error (see <span><a href="https://rfc-editor.org/rfc/rfc9290#section-2" class="relref">Section 2</a> of [<a href="#RFC9290" class="cite xref">RFC9290</a>]</span>).<a href="#section-7-6.1.2.1.1" class="pilcrow">¶</a></p>
<p id="section-7-6.1.2.1.2">
The diagnostic text is intended for software engineers as well as for device and network operators in order to aid in debugging and provide context for possible intervention. The diagnostic message <span class="bcp14">SHOULD</span> be logged by the sender of the error response. The "detail" entry is unlikely to be relevant in an unattended setup where human intervention is not expected.<a href="#section-7-6.1.2.1.2" class="pilcrow">¶</a></p>
<p id="section-7-6.1.2.1.3">
When the Standard Problem Detail entry "detail" is included, it conveys the same information that the original payload format conveys through the "error_description" parameter (see, e.g., Sections <a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.3" class="relref">5.8.3</a> and <a href="https://rfc-editor.org/rfc/rfc9200#section-5.9.3" class="relref">5.9.3</a> of <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>).<a href="#section-7-6.1.2.1.3" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7-6.1.2.2">
              <p id="section-7-6.1.2.2.1">"instance" (map key -3): its value is a URI reference identifying the specific occurrence of the error (see <span><a href="https://rfc-editor.org/rfc/rfc9290#section-2" class="relref">Section 2</a> of [<a href="#RFC9290" class="cite xref">RFC9290</a>]</span>).<a href="#section-7-6.1.2.2.1" class="pilcrow">¶</a></p>
<p id="section-7-6.1.2.2.2">
When the Standard Problem Detail entry "instance" is included, it conveys the same information that the original payload format conveys through the "error_uri" parameter (see, e.g., Sections <a href="https://rfc-editor.org/rfc/rfc9200#section-5.8.3" class="relref">5.8.3</a> and <a href="https://rfc-editor.org/rfc/rfc9200#section-5.9.3" class="relref">5.9.3</a> of <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>).<a href="#section-7-6.1.2.2.2" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
      </ul>
<p id="section-7-7">An example of an error response using the problem-details format is shown in <a href="#fig-example-error-response" class="auto internal xref">Figure 10</a>.<a href="#section-7-7" class="pilcrow">¶</a></p>
<span id="name-example-of-error-response-w"></span><div id="fig-example-error-response">
<figure id="figure-10">
        <div class="alignLeft art-text artwork" id="section-7-8.1">
<pre>
Header: Bad Request (Code=4.00)
Content-Format: 257 (application/concise-problem-details+cbor)
Payload:
{
  / title /  -1 : "Incompatible ACE profile",
  / detail / -2 : "The RS supports only the OSCORE profile",
    e'ace-error': {
      / error_code / 0: 8 / incompatible_ace_profiles /
    }
}
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-example-of-error-response-w" class="selfRef">Example of Error Response with Problem Details.</a>
        </figcaption></figure>
</div>
<p id="section-7-9">When the ACE framework is used with CBOR for encoding message payloads, the following applies.<a href="#section-7-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-10.1">
          <p id="section-7-10.1.1">It is <span class="bcp14">RECOMMENDED</span> that authorization servers, clients, and resource servers support the payload format defined in this section.<a href="#section-7-10.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-10.2">
          <p id="section-7-10.2.1">Authorization servers, clients, and resource servers that support the payload format defined in this section <span class="bcp14">MUST</span> use it when composing an outgoing error response that conveys an error code.<a href="#section-7-10.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="sec-updated-requirements">
<section id="section-8">
      <h2 id="name-updated-requirements-on-pro">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-updated-requirements-on-pro" class="section-name selfRef">Updated Requirements on Profiles of ACE</a>
      </h2>
<p id="section-8-1"><span><a href="https://rfc-editor.org/rfc/rfc9200#appendix-C" class="relref">Appendix C</a> of [<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> compiles a list of requirements on the profiles of ACE. This document amends two of those requirements as follows.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">The text of the fifth requirement<a href="#section-8-2" class="pilcrow">¶</a></p>
<blockquote id="section-8-3">
        <p id="section-8-3.1">Specify the security protocol the client and RS must use to protect their communication (e.g., OSCORE or DTLS). This must provide encryption and integrity and replay protection (Section 5.8.4.3).<a href="#section-8-3.1" class="pilcrow">¶</a></p>
</blockquote>
<p id="section-8-4">is replaced by the following text:<a href="#section-8-4" class="pilcrow">¶</a></p>
<blockquote id="section-8-5">
        <p id="section-8-5.1">Specify the security protocol the client and RS must use to protect their communication (e.g., OSCORE or DTLS). In combination with the used communication protocol, this must provide encryption, integrity and replay protection, and a binding between requests and responses (Section 5.8.4.3 and Section 6.5).<a href="#section-8-5.1" class="pilcrow">¶</a></p>
</blockquote>
<p id="section-8-6">The text of the tenth requirement<a href="#section-8-6" class="pilcrow">¶</a></p>
<blockquote id="section-8-7">
        <p id="section-8-7.1">Specify the communication and security protocol for interactions between the client and AS. This must provide encryption, integrity protection, replay protection, and a binding between requests and responses (Sections 5 and 5.8).<a href="#section-8-7.1" class="pilcrow">¶</a></p>
</blockquote>
<p id="section-8-8">is replaced by the following text:<a href="#section-8-8" class="pilcrow">¶</a></p>
<blockquote id="section-8-9">
        <p id="section-8-9.1">Specify the communication and security protocol for interactions between the client and AS. The combined use of those protocols must provide encryption, integrity protection, replay protection, and a binding between requests and responses (Sections 5 and 5.8).<a href="#section-8-9.1" class="pilcrow">¶</a></p>
</blockquote>
<p id="section-8-10">At the time of writing, all the profiles of ACE that are published as RFC (i.e., <span>[<a href="#RFC9202" class="cite xref">RFC9202</a>]</span><span>[<a href="#RFC9203" class="cite xref">RFC9203</a>]</span><span>[<a href="#RFC9431" class="cite xref">RFC9431</a>]</span>) already comply with the two updated requirements as formulated above.<a href="#section-8-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-9">
      <h2 id="name-security-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-9-1">The same security considerations from the ACE framework for Authentication and Authorization <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> apply to this document, together with those from the specific profile of ACE used, e.g., <span>[<a href="#RFC9202" class="cite xref">RFC9202</a>]</span><span>[<a href="#RFC9203" class="cite xref">RFC9203</a>]</span><span>[<a href="#RFC9431" class="cite xref">RFC9431</a>]</span><span>[<a href="#I-D.ietf-ace-edhoc-oscore-profile" class="cite xref">I-D.ietf-ace-edhoc-oscore-profile</a>]</span><span>[<a href="#I-D.ietf-ace-group-oscore-profile" class="cite xref">I-D.ietf-ace-group-oscore-profile</a>]</span><span>[<a href="#RFC9431" class="cite xref">RFC9431</a>]</span>.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">When using the problem-details format defined in <span>[<a href="#RFC9290" class="cite xref">RFC9290</a>]</span> for error responses, then the privacy and security considerations from Sections <a href="https://rfc-editor.org/rfc/rfc9290#section-4" class="relref">4</a> and <a href="https://rfc-editor.org/rfc/rfc9290#section-5" class="relref">5</a> of <span>[<a href="#RFC9290" class="cite xref">RFC9290</a>]</span> also apply.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">Editor's note: add more security considerations.<a href="#section-9-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-10-1">This document has the following actions for IANA.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">Note to RFC Editor: Please replace all occurrences of "[RFC-XXXX]" with the RFC number of this specification and delete this paragraph.<a href="#section-10-2" class="pilcrow">¶</a></p>
<div id="iana-oauth-params">
<section id="section-10.1">
        <h3 id="name-oauth-parameters-registry">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-oauth-parameters-registry" class="section-name selfRef">OAuth Parameters Registry</a>
        </h3>
<p id="section-10.1-1">IANA is asked to add the following entries to the "OAuth Parameters" registry within the "OAuth Parameters" registry group.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.1-2.1">
            <p id="section-10.1-2.1.1">Name: token_upload<a href="#section-10.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-2.2">
            <p id="section-10.1-2.2.1">Parameter Usage Location: token request, token response<a href="#section-10.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-2.3">
            <p id="section-10.1-2.3.1">Change Controller: IETF<a href="#section-10.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-2.4">
            <p id="section-10.1-2.4.1">Reference: [RFC-XXXX]<a href="#section-10.1-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.1-3"><br></p>
<ul class="normal">
<li class="normal" id="section-10.1-4.1">
            <p id="section-10.1-4.1.1">Name: token_hash<a href="#section-10.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-4.2">
            <p id="section-10.1-4.2.1">Parameter Usage Location: token response<a href="#section-10.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-4.3">
            <p id="section-10.1-4.3.1">Change Controller: IETF<a href="#section-10.1-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-4.4">
            <p id="section-10.1-4.4.1">Reference: [RFC-XXXX]<a href="#section-10.1-4.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.1-5"><br></p>
<ul class="normal">
<li class="normal" id="section-10.1-6.1">
            <p id="section-10.1-6.1.1">Name: to_rs<a href="#section-10.1-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-6.2">
            <p id="section-10.1-6.2.1">Parameter Usage Location: token request<a href="#section-10.1-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-6.3">
            <p id="section-10.1-6.3.1">Change Controller: IETF<a href="#section-10.1-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-6.4">
            <p id="section-10.1-6.4.1">Reference: [RFC-XXXX]<a href="#section-10.1-6.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.1-7"><br></p>
<ul class="normal">
<li class="normal" id="section-10.1-8.1">
            <p id="section-10.1-8.1.1">Name: from_rs<a href="#section-10.1-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-8.2">
            <p id="section-10.1-8.2.1">Parameter Usage Location: token response<a href="#section-10.1-8.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-8.3">
            <p id="section-10.1-8.3.1">Change Controller: IETF<a href="#section-10.1-8.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-8.4">
            <p id="section-10.1-8.4.1">Reference: [RFC-XXXX]<a href="#section-10.1-8.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.1-9"><br></p>
<ul class="normal">
<li class="normal" id="section-10.1-10.1">
            <p id="section-10.1-10.1.1">Name: rs_cnf2<a href="#section-10.1-10.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-10.2">
            <p id="section-10.1-10.2.1">Parameter Usage Location: token response<a href="#section-10.1-10.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-10.3">
            <p id="section-10.1-10.3.1">Change Controller: IETF<a href="#section-10.1-10.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-10.4">
            <p id="section-10.1-10.4.1">Reference: [RFC-XXXX]<a href="#section-10.1-10.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.1-11"><br></p>
<ul class="normal">
<li class="normal" id="section-10.1-12.1">
            <p id="section-10.1-12.1.1">Name: audience2<a href="#section-10.1-12.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-12.2">
            <p id="section-10.1-12.2.1">Parameter Usage Location: token response<a href="#section-10.1-12.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-12.3">
            <p id="section-10.1-12.3.1">Change Controller: IETF<a href="#section-10.1-12.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-12.4">
            <p id="section-10.1-12.4.1">Reference: [RFC-XXXX]<a href="#section-10.1-12.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.1-13"><br></p>
<ul class="normal">
<li class="normal" id="section-10.1-14.1">
            <p id="section-10.1-14.1.1">Name: anchor_cnf<a href="#section-10.1-14.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-14.2">
            <p id="section-10.1-14.2.1">Parameter Usage Location: token response<a href="#section-10.1-14.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-14.3">
            <p id="section-10.1-14.3.1">Change Controller: IETF<a href="#section-10.1-14.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-14.4">
            <p id="section-10.1-14.4.1">Reference: [RFC-XXXX]<a href="#section-10.1-14.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.1-15"><br></p>
<ul class="normal">
<li class="normal" id="section-10.1-16.1">
            <p id="section-10.1-16.1.1">Name: token_series_id<a href="#section-10.1-16.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-16.2">
            <p id="section-10.1-16.2.1">Parameter Usage Location: token request, token response<a href="#section-10.1-16.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-16.3">
            <p id="section-10.1-16.3.1">Change Controller: IETF<a href="#section-10.1-16.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-16.4">
            <p id="section-10.1-16.4.1">Reference: [RFC-XXXX]<a href="#section-10.1-16.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.1-17"><br></p>
<ul class="normal">
<li class="normal" id="section-10.1-18.1">
            <p id="section-10.1-18.1.1">Name: updated_rights<a href="#section-10.1-18.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-18.2">
            <p id="section-10.1-18.2.1">Parameter Usage Location: as-rs request<a href="#section-10.1-18.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-18.3">
            <p id="section-10.1-18.3.1">Change Controller: IETF<a href="#section-10.1-18.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-18.4">
            <p id="section-10.1-18.4.1">Reference: [RFC-XXXX]<a href="#section-10.1-18.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.1-19"><br></p>
<p id="section-10.1-20">In the same registry, IANA is asked to update the entries for the following OAuth parameters identified by their name, so that the content of the "Parameter Usage Location" column and of the "Reference" column is as below:<a href="#section-10.1-20" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.1-21.1">
            <p id="section-10.1-21.1.1">rs_cnf<a href="#section-10.1-21.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.1-21.1.2.1">
                <p id="section-10.1-21.1.2.1.1">Parameter Usage Location: token request, token response<a href="#section-10.1-21.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-10.1-21.1.2.2">
                <p id="section-10.1-21.1.2.2.1">Reference: [RFC9201, Section 5][RFC-XXXX, <a href="#sec-cred-rs-value" class="auto internal xref">Section 5.2</a>]<a href="#section-10.1-21.1.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-10.1-21.2">
            <p id="section-10.1-21.2.1">nonce1<a href="#section-10.1-21.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.1-21.2.2.1">
                <p id="section-10.1-21.2.2.1.1">Parameter Usage Location: client-rs request, as-rs request<a href="#section-10.1-21.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-10.1-21.2.2.2">
                <p id="section-10.1-21.2.2.2.1">Reference: [RFC9203][RFC-XXXX]<a href="#section-10.1-21.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-10.1-21.3">
            <p id="section-10.1-21.3.1">nonce2<a href="#section-10.1-21.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.1-21.3.2.1">
                <p id="section-10.1-21.3.2.1.1">Parameter Usage Location: rs-client response, rs-as response<a href="#section-10.1-21.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-10.1-21.3.2.2">
                <p id="section-10.1-21.3.2.2.1">Reference: [RFC9203][RFC-XXXX]<a href="#section-10.1-21.3.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-10.1-21.4">
            <p id="section-10.1-21.4.1">ace_client_recipientid<a href="#section-10.1-21.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.1-21.4.2.1">
                <p id="section-10.1-21.4.2.1.1">Parameter Usage Location: client-rs request, as-rs request<a href="#section-10.1-21.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-10.1-21.4.2.2">
                <p id="section-10.1-21.4.2.2.1">Reference: [RFC9203][RFC-XXXX]<a href="#section-10.1-21.4.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-10.1-21.5">
            <p id="section-10.1-21.5.1">ace_server_recipientid<a href="#section-10.1-21.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.1-21.5.2.1">
                <p id="section-10.1-21.5.2.1.1">Parameter Usage Location: rs-client response, rs-as response<a href="#section-10.1-21.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-10.1-21.5.2.2">
                <p id="section-10.1-21.5.2.2.1">Reference: [RFC9203][RFC-XXXX]<a href="#section-10.1-21.5.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-10.1-21.6">
            <p id="section-10.1-21.6.1">sign_info<a href="#section-10.1-21.6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.1-21.6.2.1">
                <p id="section-10.1-21.6.2.1.1">Parameter Usage Location: client-rs request, rs-client response, as-rs request, rs-as response<a href="#section-10.1-21.6.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-10.1-21.6.2.2">
                <p id="section-10.1-21.6.2.2.1">Reference: [RFC9594][RFC-XXXX]<a href="#section-10.1-21.6.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-10.1-21.7">
            <p id="section-10.1-21.7.1">kdcchallenge<a href="#section-10.1-21.7.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.1-21.7.2.1">
                <p id="section-10.1-21.7.2.1.1">Parameter Usage Location: rs-client response, rs-as response<a href="#section-10.1-21.7.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-10.1-21.7.2.2">
                <p id="section-10.1-21.7.2.2.1">Reference: [RFC9594][RFC-XXXX]<a href="#section-10.1-21.7.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
<div id="iana-oauth-cbor-mappings">
<section id="section-10.2">
        <h3 id="name-oauth-parameters-cbor-mappi">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-oauth-parameters-cbor-mappi" class="section-name selfRef">OAuth Parameters CBOR Mappings Registry</a>
        </h3>
<p id="section-10.2-1">IANA is asked to add the following entries to the "OAuth Parameters CBOR Mappings" registry within the "Authentication and Authorization for Constrained Environments (ACE)" registry group, following the procedure specified in <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span>.<a href="#section-10.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.2-2.1">
            <p id="section-10.2-2.1.1">Name: token_upload<a href="#section-10.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-2.2">
            <p id="section-10.2-2.2.1">CBOR Key: TBD (value between 1 and 255)<a href="#section-10.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-2.3">
            <p id="section-10.2-2.3.1">Value Type: unsigned integer<a href="#section-10.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-2.4">
            <p id="section-10.2-2.4.1">Reference: [RFC-XXXX]<a href="#section-10.2-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-2.5">
            <p id="section-10.2-2.5.1">Original Specification: [RFC-XXXX]<a href="#section-10.2-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.2-3"><br></p>
<ul class="normal">
<li class="normal" id="section-10.2-4.1">
            <p id="section-10.2-4.1.1">Name: token_hash<a href="#section-10.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-4.2">
            <p id="section-10.2-4.2.1">CBOR Key: TBD (value between 1 and 255)<a href="#section-10.2-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-4.3">
            <p id="section-10.2-4.3.1">Value Type: unsigned integer<a href="#section-10.2-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-4.4">
            <p id="section-10.2-4.4.1">Reference: [RFC-XXXX]<a href="#section-10.2-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-4.5">
            <p id="section-10.2-4.5.1">Original Specification: [RFC-XXXX]<a href="#section-10.2-4.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.2-5"><br></p>
<ul class="normal">
<li class="normal" id="section-10.2-6.1">
            <p id="section-10.2-6.1.1">Name: to_rs<a href="#section-10.2-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-6.2">
            <p id="section-10.2-6.2.1">CBOR Key: TBD (value between 1 and 255)<a href="#section-10.2-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-6.3">
            <p id="section-10.2-6.3.1">Value Type: Null or byte string or #6.&lt;uint&gt;(bstr)<a href="#section-10.2-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-6.4">
            <p id="section-10.2-6.4.1">Reference: [RFC-XXXX]<a href="#section-10.2-6.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-6.5">
            <p id="section-10.2-6.5.1">Original Specification: [RFC-XXXX]<a href="#section-10.2-6.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.2-7"><br></p>
<ul class="normal">
<li class="normal" id="section-10.2-8.1">
            <p id="section-10.2-8.1.1">Name: from_rs<a href="#section-10.2-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-8.2">
            <p id="section-10.2-8.2.1">CBOR Key: TBD (value between 1 and 255)<a href="#section-10.2-8.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-8.3">
            <p id="section-10.2-8.3.1">Value Type: byte string or #6.&lt;uint&gt;(bstr)<a href="#section-10.2-8.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-8.4">
            <p id="section-10.2-8.4.1">Reference: [RFC-XXXX]<a href="#section-10.2-8.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-8.5">
            <p id="section-10.2-8.5.1">Original Specification: [RFC-XXXX]<a href="#section-10.2-8.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.2-9"><br></p>
<ul class="normal">
<li class="normal" id="section-10.2-10.1">
            <p id="section-10.2-10.1.1">Name: rs_cnf2<a href="#section-10.2-10.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-10.2">
            <p id="section-10.2-10.2.1">CBOR Key: TBD (value between 1 and 255)<a href="#section-10.2-10.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-10.3">
            <p id="section-10.2-10.3.1">Value Type: array<a href="#section-10.2-10.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-10.4">
            <p id="section-10.2-10.4.1">Reference: [RFC-XXXX]<a href="#section-10.2-10.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-10.5">
            <p id="section-10.2-10.5.1">Original Specification: [RFC-XXXX]<a href="#section-10.2-10.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.2-11"><br></p>
<ul class="normal">
<li class="normal" id="section-10.2-12.1">
            <p id="section-10.2-12.1.1">Name: audience2<a href="#section-10.2-12.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-12.2">
            <p id="section-10.2-12.2.1">CBOR Key: TBD (value between 1 and 255)<a href="#section-10.2-12.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-12.3">
            <p id="section-10.2-12.3.1">Value Type: array<a href="#section-10.2-12.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-12.4">
            <p id="section-10.2-12.4.1">Reference: [RFC-XXXX]<a href="#section-10.2-12.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-12.5">
            <p id="section-10.2-12.5.1">Original Specification: [RFC-XXXX]<a href="#section-10.2-12.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.2-13"><br></p>
<ul class="normal">
<li class="normal" id="section-10.2-14.1">
            <p id="section-10.2-14.1.1">Name: anchor_cnf<a href="#section-10.2-14.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-14.2">
            <p id="section-10.2-14.2.1">CBOR Key: TBD (value between 1 and 255)<a href="#section-10.2-14.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-14.3">
            <p id="section-10.2-14.3.1">Value Type: array<a href="#section-10.2-14.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-14.4">
            <p id="section-10.2-14.4.1">Reference: [RFC-XXXX]<a href="#section-10.2-14.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-14.5">
            <p id="section-10.2-14.5.1">Original Specification: [RFC-XXXX]<a href="#section-10.2-14.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.2-15"><br></p>
<ul class="normal">
<li class="normal" id="section-10.2-16.1">
            <p id="section-10.2-16.1.1">Name: token_series_id<a href="#section-10.2-16.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-16.2">
            <p id="section-10.2-16.2.1">CBOR Key: TBD (value between 1 and 255)<a href="#section-10.2-16.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-16.3">
            <p id="section-10.2-16.3.1">Value Type: byte string<a href="#section-10.2-16.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-16.4">
            <p id="section-10.2-16.4.1">Reference: [RFC-XXXX]<a href="#section-10.2-16.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-16.5">
            <p id="section-10.2-16.5.1">Original Specification: [RFC-XXXX]<a href="#section-10.2-16.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.2-17"><br></p>
<ul class="normal">
<li class="normal" id="section-10.2-18.1">
            <p id="section-10.2-18.1.1">Name: updated_rights<a href="#section-10.2-18.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-18.2">
            <p id="section-10.2-18.2.1">CBOR Key: TBD (value between 1 and 255)<a href="#section-10.2-18.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-18.3">
            <p id="section-10.2-18.3.1">Value Type: True<a href="#section-10.2-18.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-18.4">
            <p id="section-10.2-18.4.1">Reference: [RFC-XXXX]<a href="#section-10.2-18.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-18.5">
            <p id="section-10.2-18.5.1">Original Specification: [RFC-XXXX]<a href="#section-10.2-18.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.2-19"><br></p>
<p id="section-10.2-20">In the same registry, IANA is asked to update the entry for the OAuth parameter with name "rs_cnf", so that the content of the "Value Type" column and of the "Reference" column is as below:<a href="#section-10.2-20" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.2-21.1">
            <p id="section-10.2-21.1.1">Value Type: True or False or Null or map<a href="#section-10.2-21.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-21.2">
            <p id="section-10.2-21.2.1">Reference: [RFC9201, Section 3.2][RFC-XXXX, <a href="#sec-cred-rs-value" class="auto internal xref">Section 5.2</a>]<a href="#section-10.2-21.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="iana-token-json-claims">
<section id="section-10.3">
        <h3 id="name-json-web-token-claims-regis">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-json-web-token-claims-regis" class="section-name selfRef">JSON Web Token Claims Registry</a>
        </h3>
<p id="section-10.3-1">IANA is asked to add the following entry to the "JSON Web Token Claims" registry within the "JSON Web Token (JWT)" registry group, following the procedure specified in <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#section-10.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.3-2.1">
            <p id="section-10.3-2.1.1">Claim Name: token_series_id<a href="#section-10.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.3-2.2">
            <p id="section-10.3-2.2.1">Claim Description: The identifier of a token series<a href="#section-10.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.3-2.3">
            <p id="section-10.3-2.3.1">Change Controller: IETF<a href="#section-10.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.3-2.4">
            <p id="section-10.3-2.4.1">Reference: [RFC-XXXX]<a href="#section-10.3-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="iana-token-cwt-claims">
<section id="section-10.4">
        <h3 id="name-cbor-web-token-cwt-claims-r">
<a href="#section-10.4" class="section-number selfRef">10.4. </a><a href="#name-cbor-web-token-cwt-claims-r" class="section-name selfRef">CBOR Web Token (CWT) Claims Registry</a>
        </h3>
<p id="section-10.4-1">IANA is asked to add the following entry to the "CBOR Web Token (CWT) Claims" registry within the "CBOR Web Token (CWT) Claims" registry group, following the procedure specified in <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>.<a href="#section-10.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.4-2.1">
            <p id="section-10.4-2.1.1">Claim Name: token_series_id<a href="#section-10.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.4-2.2">
            <p id="section-10.4-2.2.1">Claim Description: The identifier of a token series<a href="#section-10.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.4-2.3">
            <p id="section-10.4-2.3.1">JWT Claim Name: token_series_id<a href="#section-10.4-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.4-2.4">
            <p id="section-10.4-2.4.1">Claim Key: TBD (value between 1 and 255)<a href="#section-10.4-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.4-2.5">
            <p id="section-10.4-2.5.1">Claim Value Type: byte string<a href="#section-10.4-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.4-2.6">
            <p id="section-10.4-2.6.1">Change Controller: IETF<a href="#section-10.4-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.4-2.7">
            <p id="section-10.4-2.7.1">Reference: <a href="#sec-token_series_id" class="auto internal xref">Section 3.6</a> of [RFC-XXXX]<a href="#section-10.4-2.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="iana-oauth-extensions-errors">
<section id="section-10.5">
        <h3 id="name-oauth-extensions-error-regi">
<a href="#section-10.5" class="section-number selfRef">10.5. </a><a href="#name-oauth-extensions-error-regi" class="section-name selfRef">OAuth Extensions Error Registry</a>
        </h3>
<p id="section-10.5-1">IANA is asked to add the following entries to the "OAuth Extensions Error Registry" within the "OAuth Parameters" registry group.<a href="#section-10.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.5-2.1">
            <p id="section-10.5-2.1.1">Name: unknown_credential_referenced<a href="#section-10.5-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.5-2.2">
            <p id="section-10.5-2.2.1">Usage Location: token error response<a href="#section-10.5-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.5-2.3">
            <p id="section-10.5-2.3.1">Protocol Extension: [RFC-XXXX]<a href="#section-10.5-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.5-2.4">
            <p id="section-10.5-2.4.1">Change Controller: IETF<a href="#section-10.5-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.5-2.5">
            <p id="section-10.5-2.5.1">Reference: <a href="#sec-coord-exchanged-cred" class="auto internal xref">Section 5</a> of [RFC-XXXX]<a href="#section-10.5-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.5-3"><br></p>
<ul class="normal">
<li class="normal" id="section-10.5-4.1">
            <p id="section-10.5-4.1.1">Name: failed_pop_verification<a href="#section-10.5-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.5-4.2">
            <p id="section-10.5-4.2.1">Usage Location: token error response<a href="#section-10.5-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.5-4.3">
            <p id="section-10.5-4.3.1">Protocol Extension: [RFC-XXXX]<a href="#section-10.5-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.5-4.4">
            <p id="section-10.5-4.4.1">Change Controller: IETF<a href="#section-10.5-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.5-4.5">
            <p id="section-10.5-4.5.1">Reference: <a href="#sec-error-failed-pop" class="auto internal xref">Section 6</a> of [RFC-XXXX]<a href="#section-10.5-4.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="iana-oauth-error-code-cbor-mappings">
<section id="section-10.6">
        <h3 id="name-oauth-error-code-cbor-mappi">
<a href="#section-10.6" class="section-number selfRef">10.6. </a><a href="#name-oauth-error-code-cbor-mappi" class="section-name selfRef">OAuth Error Code CBOR Mappings Registry</a>
        </h3>
<p id="section-10.6-1">IANA is asked to add the following entries to the "OAuth Error Code CBOR Mappings" registry within the "Authentication and Authorization for Constrained Environments (ACE)" registry group.<a href="#section-10.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.6-2.1">
            <p id="section-10.6-2.1.1">Name: unknown_credential_referenced<a href="#section-10.6-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-2.2">
            <p id="section-10.6-2.2.1">CBOR Value: TBD (value between 1 and 255)<a href="#section-10.6-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-2.3">
            <p id="section-10.6-2.3.1">Reference: [RFC-XXXX]<a href="#section-10.6-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-2.4">
            <p id="section-10.6-2.4.1">Original Specification: [RFC-XXXX]<a href="#section-10.6-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.6-3"><br></p>
<ul class="normal">
<li class="normal" id="section-10.6-4.1">
            <p id="section-10.6-4.1.1">Name: failed_pop_verification<a href="#section-10.6-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-4.2">
            <p id="section-10.6-4.2.1">CBOR Value: TBD (value between 1 and 255)<a href="#section-10.6-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-4.3">
            <p id="section-10.6-4.3.1">Reference: [RFC-XXXX]<a href="#section-10.6-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-4.4">
            <p id="section-10.6-4.4.1">Original Specification: [RFC-XXXX]<a href="#section-10.6-4.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="iana-problem-details">
<section id="section-10.7">
        <h3 id="name-custom-problem-detail-keys-">
<a href="#section-10.7" class="section-number selfRef">10.7. </a><a href="#name-custom-problem-detail-keys-" class="section-name selfRef">Custom Problem Detail Keys Registry</a>
        </h3>
<p id="section-10.7-1">IANA is asked to register the following entry in the "Custom Problem Detail Keys" registry within the "Constrained RESTful Environments (CoRE) Parameters" registry group.<a href="#section-10.7-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.7-2.1">
            <p id="section-10.7-2.1.1">Key Value: TBD (value between 0 and 23)<a href="#section-10.7-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-2.2">
            <p id="section-10.7-2.2.1">Name: ace-error<a href="#section-10.7-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-2.3">
            <p id="section-10.7-2.3.1">Brief Description: Carry ACE <span>[<a href="#RFC9200" class="cite xref">RFC9200</a>]</span> problem details in a Concise Problem Details data item.<a href="#section-10.7-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-2.4">
            <p id="section-10.7-2.4.1">Change Controller: IETF<a href="#section-10.7-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-2.5">
            <p id="section-10.7-2.5.1">Reference: <a href="#sec-updated-error-responses" class="auto internal xref">Section 7</a> of [RFC-XXXX]<a href="#section-10.7-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-11">
      <h2 id="name-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-11.1">
        <h3 id="name-normative-references">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="ACE.OAuth.Error.Code.CBOR.Mappings">[ACE.OAuth.Error.Code.CBOR.Mappings]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"OAuth Error Code CBOR Mappings"</span>, <span>&lt;<a href="https://www.iana.org/assignments/ace/ace.xhtml#oauth-error-code-cbor-mappings">https://www.iana.org/assignments/ace/ace.xhtml#oauth-error-code-cbor-mappings</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-edhoc-oscore-profile">[I-D.ietf-ace-edhoc-oscore-profile]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J. P.</span>, <span class="refAuthor">Tiloca, M.</span>, and <span class="refAuthor">R. Höglund</span>, <span class="refTitle">"Ephemeral Diffie-Hellman Over COSE (EDHOC) and Object Security for Constrained Environments (OSCORE) Profile for Authentication and Authorization for Constrained Environments (ACE)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-edhoc-oscore-profile-09</span>, <time datetime="2025-10-20" class="refDate">20 October 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-edhoc-oscore-profile-09">https://datatracker.ietf.org/doc/html/draft-ietf-ace-edhoc-oscore-profile-09</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.Hash.Algorithms">[IANA.Hash.Algorithms]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Named Information Hash Algorithm Registry"</span>, <span>&lt;<a href="https://www.iana.org/assignments/named-information/named-information.xhtml">https://www.iana.org/assignments/named-information/named-information.xhtml</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3629">[RFC3629]</dt>
        <dd>
<span class="refAuthor">Yergeau, F.</span>, <span class="refTitle">"UTF-8, a transformation format of ISO 10646"</span>, <span class="seriesInfo">STD 63</span>, <span class="seriesInfo">RFC 3629</span>, <span class="seriesInfo">DOI 10.17487/RFC3629</span>, <time datetime="2003-11" class="refDate">November 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3629">https://www.rfc-editor.org/rfc/rfc3629</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4648">[RFC4648]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span>, <span class="refTitle">"The Base16, Base32, and Base64 Data Encodings"</span>, <span class="seriesInfo">RFC 4648</span>, <span class="seriesInfo">DOI 10.17487/RFC4648</span>, <time datetime="2006-10" class="refDate">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4648">https://www.rfc-editor.org/rfc/rfc4648</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
        <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6749">https://www.rfc-editor.org/rfc/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6920">[RFC6920]</dt>
        <dd>
<span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Kutscher, D.</span>, <span class="refAuthor">Dannewitz, C.</span>, <span class="refAuthor">Ohlman, B.</span>, <span class="refAuthor">Keranen, A.</span>, and <span class="refAuthor">P. Hallam-Baker</span>, <span class="refTitle">"Naming Things with Hashes"</span>, <span class="seriesInfo">RFC 6920</span>, <span class="seriesInfo">DOI 10.17487/RFC6920</span>, <time datetime="2013-04" class="refDate">April 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6920">https://www.rfc-editor.org/rfc/rfc6920</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7252">https://www.rfc-editor.org/rfc/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7519">https://www.rfc-editor.org/rfc/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7800">[RFC7800]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Proof-of-Possession Key Semantics for JSON Web Tokens (JWTs)"</span>, <span class="seriesInfo">RFC 7800</span>, <span class="seriesInfo">DOI 10.17487/RFC7800</span>, <time datetime="2016-04" class="refDate">April 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7800">https://www.rfc-editor.org/rfc/rfc7800</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8259">[RFC8259]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time datetime="2017-12" class="refDate">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8259">https://www.rfc-editor.org/rfc/rfc8259</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8392">https://www.rfc-editor.org/rfc/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8610">[RFC8610]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8610">https://www.rfc-editor.org/rfc/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8747">[RFC8747]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Proof-of-Possession Key Semantics for CBOR Web Tokens (CWTs)"</span>, <span class="seriesInfo">RFC 8747</span>, <span class="seriesInfo">DOI 10.17487/RFC8747</span>, <time datetime="2020-03" class="refDate">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8747">https://www.rfc-editor.org/rfc/rfc8747</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8949">https://www.rfc-editor.org/rfc/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9052">[RFC9052]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Structures and Process"</span>, <span class="seriesInfo">STD 96</span>, <span class="seriesInfo">RFC 9052</span>, <span class="seriesInfo">DOI 10.17487/RFC9052</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9052">https://www.rfc-editor.org/rfc/rfc9052</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9053">[RFC9053]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Initial Algorithms"</span>, <span class="seriesInfo">RFC 9053</span>, <span class="seriesInfo">DOI 10.17487/RFC9053</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9053">https://www.rfc-editor.org/rfc/rfc9053</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9200">[RFC9200]</dt>
        <dd>
<span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Authentication and Authorization for Constrained Environments Using the OAuth 2.0 Framework (ACE-OAuth)"</span>, <span class="seriesInfo">RFC 9200</span>, <span class="seriesInfo">DOI 10.17487/RFC9200</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9200">https://www.rfc-editor.org/rfc/rfc9200</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9201">[RFC9201]</dt>
        <dd>
<span class="refAuthor">Seitz, L.</span>, <span class="refTitle">"Additional OAuth Parameters for Authentication and Authorization for Constrained Environments (ACE)"</span>, <span class="seriesInfo">RFC 9201</span>, <span class="seriesInfo">DOI 10.17487/RFC9201</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9201">https://www.rfc-editor.org/rfc/rfc9201</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9202">[RFC9202]</dt>
        <dd>
<span class="refAuthor">Gerdes, S.</span>, <span class="refAuthor">Bergmann, O.</span>, <span class="refAuthor">Bormann, C.</span>, <span class="refAuthor">Selander, G.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Datagram Transport Layer Security (DTLS) Profile for Authentication and Authorization for Constrained Environments (ACE)"</span>, <span class="seriesInfo">RFC 9202</span>, <span class="seriesInfo">DOI 10.17487/RFC9202</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9202">https://www.rfc-editor.org/rfc/rfc9202</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9203">[RFC9203]</dt>
        <dd>
<span class="refAuthor">Palombini, F.</span>, <span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, and <span class="refAuthor">M. Gunnarsson</span>, <span class="refTitle">"The Object Security for Constrained RESTful Environments (OSCORE) Profile of the Authentication and Authorization for Constrained Environments (ACE) Framework"</span>, <span class="seriesInfo">RFC 9203</span>, <span class="seriesInfo">DOI 10.17487/RFC9203</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9203">https://www.rfc-editor.org/rfc/rfc9203</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9277">[RFC9277]</dt>
        <dd>
<span class="refAuthor">Richardson, M.</span> and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"On Stable Storage for Items in Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">RFC 9277</span>, <span class="seriesInfo">DOI 10.17487/RFC9277</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9277">https://www.rfc-editor.org/rfc/rfc9277</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9290">[RFC9290]</dt>
        <dd>
<span class="refAuthor">Fossati, T.</span> and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Problem Details for Constrained Application Protocol (CoAP) APIs"</span>, <span class="seriesInfo">RFC 9290</span>, <span class="seriesInfo">DOI 10.17487/RFC9290</span>, <time datetime="2022-10" class="refDate">October 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9290">https://www.rfc-editor.org/rfc/rfc9290</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9430">[RFC9430]</dt>
        <dd>
<span class="refAuthor">Bergmann, O.</span>, <span class="refAuthor">Preuß Mattsson, J.</span>, and <span class="refAuthor">G. Selander</span>, <span class="refTitle">"Extension of the Datagram Transport Layer Security (DTLS) Profile for Authentication and Authorization for Constrained Environments (ACE) to Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 9430</span>, <span class="seriesInfo">DOI 10.17487/RFC9430</span>, <time datetime="2023-07" class="refDate">July 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9430">https://www.rfc-editor.org/rfc/rfc9430</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9431">[RFC9431]</dt>
        <dd>
<span class="refAuthor">Sengul, C.</span> and <span class="refAuthor">A. Kirby</span>, <span class="refTitle">"Message Queuing Telemetry Transport (MQTT) and Transport Layer Security (TLS) Profile of Authentication and Authorization for Constrained Environments (ACE) Framework"</span>, <span class="seriesInfo">RFC 9431</span>, <span class="seriesInfo">DOI 10.17487/RFC9431</span>, <time datetime="2023-07" class="refDate">July 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9431">https://www.rfc-editor.org/rfc/rfc9431</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9770">[RFC9770]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Palombini, F.</span>, <span class="refAuthor">Echeverria, S.</span>, and <span class="refAuthor">G. Lewis</span>, <span class="refTitle">"Notification of Revoked Access Tokens in the Authentication and Authorization for Constrained Environments (ACE) Framework"</span>, <span class="seriesInfo">RFC 9770</span>, <span class="seriesInfo">DOI 10.17487/RFC9770</span>, <time datetime="2025-06" class="refDate">June 2025</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9770">https://www.rfc-editor.org/rfc/rfc9770</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SHA-256">[SHA-256]</dt>
      <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"Secure Hash Standard"</span>, <span class="seriesInfo">NIST FIPS PUB 180-4, DOI 10.6028/NIST.FIPS.180-4 </span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-11.2">
        <h3 id="name-informative-references">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-ace-authcred-dtls-profile">[I-D.ietf-ace-authcred-dtls-profile]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span> and <span class="refAuthor">J. P. Mattsson</span>, <span class="refTitle">"Additional Formats of Authentication Credentials for the Datagram Transport Layer Security (DTLS) Profile for Authentication and Authorization for Constrained Environments (ACE)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-authcred-dtls-profile-03</span>, <time datetime="2026-01-07" class="refDate">7 January 2026</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-authcred-dtls-profile-03">https://datatracker.ietf.org/doc/html/draft-ietf-ace-authcred-dtls-profile-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-group-oscore-profile">[I-D.ietf-ace-group-oscore-profile]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Höglund, R.</span>, and <span class="refAuthor">F. Palombini</span>, <span class="refTitle">"The Group Object Security for Constrained RESTful Environments (Group OSCORE) Profile of the Authentication and Authorization for Constrained Environments (ACE) Framework"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-group-oscore-profile-05</span>, <time datetime="2025-09-03" class="refDate">3 September 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-group-oscore-profile-05">https://datatracker.ietf.org/doc/html/draft-ietf-ace-group-oscore-profile-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9594">[RFC9594]</dt>
      <dd>
<span class="refAuthor">Palombini, F.</span> and <span class="refAuthor">M. Tiloca</span>, <span class="refTitle">"Key Provisioning for Group Communication Using Authentication and Authorization for Constrained Environments (ACE)"</span>, <span class="seriesInfo">RFC 9594</span>, <span class="seriesInfo">DOI 10.17487/RFC9594</span>, <time datetime="2024-09" class="refDate">September 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9594">https://www.rfc-editor.org/rfc/rfc9594</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="sec-benefits-for-profiles">
<section id="appendix-A">
      <h2 id="name-benefits-for-ace-profiles">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-benefits-for-ace-profiles" class="section-name selfRef">Benefits for ACE Profiles</a>
      </h2>
<p id="appendix-A-1">For any profile of ACE, the following holds.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-2.1">
          <p id="appendix-A-2.1.1">The SDC workflow defined in <a href="#sec-workflow" class="auto internal xref">Section 2</a> is effectively possible to use. This is beneficial for deployments where the communication leg between C and the RS is constrained, but the communication leg between the AS and RS is not.<a href="#appendix-A-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-2.2">
          <p id="appendix-A-2.2.1">When the SDC workflow is used, the "token_upload" parameter defined in <a href="#sec-token_upload" class="auto internal xref">Section 3.1</a> is used:<a href="#appendix-A-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-2.2.2.1">
              <p id="appendix-A-2.2.2.1.1">To inform the AS about C opting in to use the SDC workflow.<a href="#appendix-A-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-A-2.2.2.2">
              <p id="appendix-A-2.2.2.2.1">To request the AS that the follow-up access token response includes certain information, if the AS has successfully uploaded the access token to the RS.<a href="#appendix-A-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-A-2.2.2.3">
              <p id="appendix-A-2.2.2.3.1">To inform C that the AS has attempted to upload the issued access token to the RS, specifying whether the uploading has succeeded or failed.<a href="#appendix-A-2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="appendix-A-2.3">
          <p id="appendix-A-2.3.1">When the SDC workflow is used, it remains possible for C to always obtain the issued access token from the AS.<a href="#appendix-A-2.3.1" class="pilcrow">¶</a></p>
<p id="appendix-A-2.3.2">
That is, by specifying the value 2 for the "token_upload" parameter in the access token request, C will ensure to receive the access token from the AS, even if the AS successfully uploads the access token to the RS on behalf of C.<a href="#appendix-A-2.3.2" class="pilcrow">¶</a></p>
<p id="appendix-A-2.3.3">
This is useful in profiles of ACE where C can re-upload the same access token to the RS by itself, e.g., in order to perform a key update like defined for the OSCORE profile <span>[<a href="#RFC9203" class="cite xref">RFC9203</a>]</span>.<a href="#appendix-A-2.3.3" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="dtls-profile">
<section id="appendix-A.1">
        <h3 id="name-dtls-profile">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-dtls-profile" class="section-name selfRef">DTLS Profile</a>
        </h3>
<p id="appendix-A.1-1">When the RPK mode of the DTLS profile is used (see <span><a href="https://rfc-editor.org/rfc/rfc9202#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC9202" class="cite xref">RFC9202</a>]</span>), it becomes possible for the AS to effectively issue an access token intended to an audience that includes multiple RSs.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1-2">This is enabled by the parameters "rs_cnf2" and "audience2" defined in <a href="#sec-rs_cnf2-audience2" class="auto internal xref">Section 3.4</a>, as well as by the "anchor_cnf" parameter defined in <a href="#sec-anchor_cnf" class="auto internal xref">Section 3.5</a>. This seamlessly applies also if the profile uses Transport Layer Security (TLS) <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span> as defined in <span>[<a href="#RFC9430" class="cite xref">RFC9430</a>]</span>.<a href="#appendix-A.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="edhoc-and-oscore-profile">
<section id="appendix-A.2">
        <h3 id="name-edhoc-and-oscore-profile">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-edhoc-and-oscore-profile" class="section-name selfRef">EDHOC and OSCORE Profile</a>
        </h3>
<p id="appendix-A.2-1">When the EDHOC and OSCORE profile is used <span>[<a href="#I-D.ietf-ace-edhoc-oscore-profile" class="cite xref">I-D.ietf-ace-edhoc-oscore-profile</a>]</span>, it becomes possible for the AS to effectively issue an access token intended to an audience that includes multiple RSs.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2-2">This is enabled by the parameters "rs_cnf2" and "audience2" defined in <a href="#sec-rs_cnf2-audience2" class="auto internal xref">Section 3.4</a>, as well as by the "anchor_cnf" parameter defined in <a href="#sec-anchor_cnf" class="auto internal xref">Section 3.5</a>.<a href="#appendix-A.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-cddl-model">
<section id="appendix-B">
      <h2 id="name-cddl-model">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-cddl-model" class="section-name selfRef">CDDL Model</a>
      </h2>
<p id="appendix-B-1">This section is to be removed before publishing as an RFC.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<span id="name-cddl-model-2"></span><div id="fig-cddl-model">
<figure id="figure-11">
        <div class="alignLeft art-CDDL art-text artwork" id="appendix-B-2.1">
<pre>
; OAuth Parameters CBOR Mappings
token_upload = 49
token_hash = 50
to_rs = 51
from_rs = 52
rs_cnf2 = 53
audience2 = 54
anchor_cnf = 55
token_series_id_param = 56

; CBOR Web Token (CWT) Claims
token_series_id_claim = 42

; CWT Confirmation Methods
x5chain = 24

; Custom Problem Detail Keys Registry
ace-error = 2
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-cddl-model-2" class="selfRef">CDDL model</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="sec-document-updates">
<section id="appendix-C">
      <h2 id="name-document-updates">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-document-updates" class="section-name selfRef">Document Updates</a>
      </h2>
<p id="appendix-C-1">This section is to be removed before publishing as an RFC.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<div id="sec-06-07">
<section id="appendix-C.1">
        <h3 id="name-version-06-to-07">
<a href="#appendix-C.1" class="section-number selfRef">C.1. </a><a href="#name-version-06-to-07" class="section-name selfRef">Version -06 to -07</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.1-1.1">
            <p id="appendix-C.1-1.1.1">Clarifications:<a href="#appendix-C.1-1.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.1-1.1.2.1">
                <p id="appendix-C.1-1.1.2.1.1">Access token responses are successful by definition.<a href="#appendix-C.1-1.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.1-1.1.2.2">
                <p id="appendix-C.1-1.1.2.2.1">Successful response in general vs. response with 2.01 code.<a href="#appendix-C.1-1.1.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="appendix-C.1-1.2">
            <p id="appendix-C.1-1.2.1">Editorial fixes and improvements.<a href="#appendix-C.1-1.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-05-06">
<section id="appendix-C.2">
        <h3 id="name-version-05-to-06">
<a href="#appendix-C.2" class="section-number selfRef">C.2. </a><a href="#name-version-05-to-06" class="section-name selfRef">Version -05 to -06</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.2-1.1">
            <p id="appendix-C.2-1.1.1">Defined dynamic update of access rights in the SDC workflow.<a href="#appendix-C.2-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.2-1.2">
            <p id="appendix-C.2-1.2.1">Defined the new "updated_rights" parameter.<a href="#appendix-C.2-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.2-1.3">
            <p id="appendix-C.2-1.3.1">Clarified practical requirements at the AS for processing the "to_rs" parameter.<a href="#appendix-C.2-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.2-1.4">
            <p id="appendix-C.2-1.4.1">IANA considerations: update in the "Parameter Usage Location" column for some entries of the "OAuth Parameters" registry.<a href="#appendix-C.2-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.2-1.5">
            <p id="appendix-C.2-1.5.1">Adjusted abbreviations in the CDDL model to avoid collisions.<a href="#appendix-C.2-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.2-1.6">
            <p id="appendix-C.2-1.6.1">Removed appendix with placeholder ideas.<a href="#appendix-C.2-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.2-1.7">
            <p id="appendix-C.2-1.7.1">Editorial fixes and improvements.<a href="#appendix-C.2-1.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-04-05">
<section id="appendix-C.3">
        <h3 id="name-version-04-to-05">
<a href="#appendix-C.3" class="section-number selfRef">C.3. </a><a href="#name-version-04-to-05" class="section-name selfRef">Version -04 to -05</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.3-1.1">
            <p id="appendix-C.3-1.1.1">Error handling and error code for failed PoP verification at the AS.<a href="#appendix-C.3-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-1.2">
            <p id="appendix-C.3-1.2.1">Extended definition of the parameters "to_rs" and "from_rs".<a href="#appendix-C.3-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-1.3">
            <p id="appendix-C.3-1.3.1">Fixes and presentation improvements in the IANA considerations.<a href="#appendix-C.3-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-1.4">
            <p id="appendix-C.3-1.4.1">Updated references.<a href="#appendix-C.3-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-1.5">
            <p id="appendix-C.3-1.5.1">Revised order of some sections.<a href="#appendix-C.3-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-1.6">
            <p id="appendix-C.3-1.6.1">Editorial fixes and improvements.<a href="#appendix-C.3-1.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-03-04">
<section id="appendix-C.4">
        <h3 id="name-version-03-to-04">
<a href="#appendix-C.4" class="section-number selfRef">C.4. </a><a href="#name-version-03-to-04" class="section-name selfRef">Version -03 to -04</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.4-1.1">
            <p id="appendix-C.4-1.1.1">Updated document title.<a href="#appendix-C.4-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.4-1.2">
            <p id="appendix-C.4-1.2.1">Defined name for the new workflow.<a href="#appendix-C.4-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.4-1.3">
            <p id="appendix-C.4-1.3.1">Improved definition of "token series".<a href="#appendix-C.4-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.4-1.4">
            <p id="appendix-C.4-1.4.1">Revised note on the new workflow suitable for "unaware" clients.<a href="#appendix-C.4-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.4-1.5">
            <p id="appendix-C.4-1.5.1">Revised criterion for the AS to choose a token series identifier.<a href="#appendix-C.4-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.4-1.6">
            <p id="appendix-C.4-1.6.1">Extended semantics of the "ace_profile" parameter.<a href="#appendix-C.4-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.4-1.7">
            <p id="appendix-C.4-1.7.1">Specified means for C and the AS to coordinate on the exchange of public authentication credentials.<a href="#appendix-C.4-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.4-1.8">
            <p id="appendix-C.4-1.8.1">Removed content on bidirectional access control.<a href="#appendix-C.4-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.4-1.9">
            <p id="appendix-C.4-1.9.1">Suggested value ranges for codepoints to register.<a href="#appendix-C.4-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.4-1.10">
            <p id="appendix-C.4-1.10.1">Editorial fixes and improvements.<a href="#appendix-C.4-1.10.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-02-03">
<section id="appendix-C.5">
        <h3 id="name-version-02-to-03">
<a href="#appendix-C.5" class="section-number selfRef">C.5. </a><a href="#name-version-02-to-03" class="section-name selfRef">Version -02 to -03</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.5-1.1">
            <p id="appendix-C.5-1.1.1">Defined parameter and claim "token_series_id".<a href="#appendix-C.5-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.5-1.2">
            <p id="appendix-C.5-1.2.1">Defined parameters "to_rs" and "from_rs".<a href="#appendix-C.5-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.5-1.3">
            <p id="appendix-C.5-1.3.1">Defined use of "to_rs" and "from_rs" in the OSCORE profile.<a href="#appendix-C.5-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.5-1.4">
            <p id="appendix-C.5-1.4.1">Lowercase use of "client", "resource server", and "authorization server".<a href="#appendix-C.5-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.5-1.5">
            <p id="appendix-C.5-1.5.1">Fixed naming of parameters/claims for audience.<a href="#appendix-C.5-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.5-1.6">
            <p id="appendix-C.5-1.6.1">Split elision and comments in the examples in CBOR Diagnostic Notation.<a href="#appendix-C.5-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.5-1.7">
            <p id="appendix-C.5-1.7.1">SHA-256 is mandatory to implement for computing token hashes.<a href="#appendix-C.5-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.5-1.8">
            <p id="appendix-C.5-1.8.1">Fixes in the IANA considerations.<a href="#appendix-C.5-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.5-1.9">
            <p id="appendix-C.5-1.9.1">Removed (parts of) appendices that are not needed anymore.<a href="#appendix-C.5-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.5-1.10">
            <p id="appendix-C.5-1.10.1">Clarifications and editorial improvements.<a href="#appendix-C.5-1.10.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-01-02">
<section id="appendix-C.6">
        <h3 id="name-version-01-to-02">
<a href="#appendix-C.6" class="section-number selfRef">C.6. </a><a href="#name-version-01-to-02" class="section-name selfRef">Version -01 to -02</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.6-1.1">
            <p id="appendix-C.6-1.1.1">CBOR diagnostic notation uses placeholders from a CDDL model.<a href="#appendix-C.6-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.6-1.2">
            <p id="appendix-C.6-1.2.1">Note on the new workflow supporting also non-ACE clients.<a href="#appendix-C.6-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.6-1.3">
            <p id="appendix-C.6-1.3.1">Revised semantics of the "token_upload" parameter.<a href="#appendix-C.6-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.6-1.4">
            <p id="appendix-C.6-1.4.1">Defined the new "token_hash" parameter.<a href="#appendix-C.6-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.6-1.5">
            <p id="appendix-C.6-1.5.1">First definition of bidirectional access control through a single access token.<a href="#appendix-C.6-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.6-1.6">
            <p id="appendix-C.6-1.6.1">Revised and extended considerations and next steps in appendices.<a href="#appendix-C.6-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.6-1.7">
            <p id="appendix-C.6-1.7.1">Clarifications and editorial improvements.<a href="#appendix-C.6-1.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-00-01">
<section id="appendix-C.7">
        <h3 id="name-version-00-to-01">
<a href="#appendix-C.7" class="section-number selfRef">C.7. </a><a href="#name-version-00-to-01" class="section-name selfRef">Version -00 to -01</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.7-1.1">
            <p id="appendix-C.7-1.1.1">Definition of the "token series" moved to the "Terminology" section.<a href="#appendix-C.7-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.7-1.2">
            <p id="appendix-C.7-1.2.1">Clarifications and fixes on using parameters in messages.<a href="#appendix-C.7-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.7-1.3">
            <p id="appendix-C.7-1.3.1">Amended two of the requirements on profiles of the framework.<a href="#appendix-C.7-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.7-1.4">
            <p id="appendix-C.7-1.4.1">The client has to opt-in for using the new workflow.<a href="#appendix-C.7-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.7-1.5">
            <p id="appendix-C.7-1.5.1">Parameter "token_uploaded" renamed to "token_upload".<a href="#appendix-C.7-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.7-1.6">
            <p id="appendix-C.7-1.6.1">Updated format of error response payload to use RFC 9290.<a href="#appendix-C.7-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.7-1.7">
            <p id="appendix-C.7-1.7.1">Security considerations inherited from other documents.<a href="#appendix-C.7-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.7-1.8">
            <p id="appendix-C.7-1.8.1">Editorial fixes and improvements.<a href="#appendix-C.7-1.8.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-D">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-D-1">The authors sincerely thank <span class="contact-name">Christian Amsüss</span>, <span class="contact-name">Rikard Höglund</span>, and <span class="contact-name">Dave Robin</span> for their comments and feedback.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<p id="appendix-D-2">This work was supported by the Sweden's Innovation Agency VINNOVA within the EUREKA CELTIC-NEXT project CYPRESS; and by the H2020 project SIFIS-Home (Grant agreement 952652).<a href="#appendix-D-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-E">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Marco Tiloca</span></div>
<div dir="auto" class="left"><span class="org">RISE AB</span></div>
<div dir="auto" class="left"><span class="street-address">Isafjordsgatan 22</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">16440</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:marco.tiloca@ri.se" class="email">marco.tiloca@ri.se</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Göran Selander</span></div>
<div dir="auto" class="left"><span class="org">Ericsson AB</span></div>
<div dir="auto" class="left"><span class="street-address">Torshamnsgatan 23</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">16440 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:goran.selander@ericsson.com" class="email">goran.selander@ericsson.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
